<!- (c) 2001 Microsoft Corporation -->
<HTML DIR="LTR">

<HEAD>
	<TITLE>ATL Server Project Wizard</TITLE>
	<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
	<STYLE TYPE="text/css">@import url();</STYLE>
	<SCRIPT>
		var strURL = "../../../";
		strURL += window.external.GetHostLocale();
		strURL += "/NewStyles.css";
		document.styleSheets(0).imports(0).href = strURL;
	</SCRIPT>
	</HEAD>

<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="OnKey();" ONKEYPRESS="OnPress();">

<TABLE CLASS="ONE" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<COL WIDTH="178"><COL>

  <!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
  <TR VALIGN="TOP">
	<TD HEIGHT="79" WIDTH="100%" COLSPAN="2">
	 <TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
	 <COL WIDTH="12"><COL><COL WIDTH="12">
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
		<DIV CLASS="SMALLA" ID="Layer1">
		 <IMG CLASS="SMALL" SRC="../../Images/AtlsWiz1.gif" WIDTH="98" HEIGHT="70" ALT="" BORDER="0" TABINDEX="-1">
		</DIV>
	   </TD>

	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65">
		<H4 CLASS="HEAD" ID="HEAD">Project Settings</H4>
		<P CLASS="SUBHEAD" ID="SUBHEAD">Choose the project types to be generated along with their names and locations.</P>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
		<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
	  	 <TR VALIGN="TOP">
	  	  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
	  	  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
	  	 </TR>
		</TABLE>
	   </TD>
	  </TR>
	 </TABLE>
	</TD>
  </TR>
  <!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->

  <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
  <TR VALIGN="TOP">
	<TD CLASS="Three" VALIGN="TOP" HEIGHT="100%" WIDTH="178">
	 <TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="178" BORDER="0" CELLPADDING="0" CELLSPACING="0">
  	  <TR VALIGN="TOP">
	   <TD CLASS="threeCustom" VALIGN="TOP" STYLE="BACKGROUND-IMAGE: URL(../../Images/ATL_Server_Background.gif);">
	   	<!--OPEN OF NAVIGATION TABLE//-->

	    <TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="12"><COL WIDTH="166"><COL WIDTH="1">
		 <TR>
	   	  <TD VALIGN="TOP" COLSPAN="3" HEIGHT="12">
	  		&nbsp;
		  </TD>
		 </TR>
		 <TR>
	   	  <TD VALIGN="TOP" HEIGHT="100%" WIDTH="12">
	  		&nbsp;
		  </TD>
	   	  <TD VALIGN="TOP" HEIGHT="100%" WIDTH="165">
	   	  <!--OPEN OF NAVIGATIONAL LINKS//-->
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="Default" TITLE="Examine an overview of selections" onClick="Next(document, 'Default.htm');" TABINDEX="1">Overview</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>

		  	<DIV CLASS="LINKSELECTED">
	 	   	 <SPAN CLASS="VERTLINE1">
			  <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
			 </SPAN>
			 <SPAN CLASS="HORILINE1">
			  <TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
				</TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD HEIGHT="100%">
				 <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="28" ALT="" BORDER="0">
			    </TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
			    </TD>
			   </TR>
			  </TABLE>
			 </SPAN>
			 <TABLE WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTSELECTED">
			  <TR VALIGN="MIDDLE">
			   <TD WIDTH="156">
				<SPAN ID="AppSettings" TITLE="Choose the project types to be generated along with their names and locations">Project Settings</SPAN>
			   </TD>
			   <TD WIDTH="4">
				<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTINDENT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="ServerOptions" TITLE="Choose the options to be supported by the ISAPI extension DLL" onClick="onClick(this);" TABINDEX="2">Server Options</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTINDENT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="AppOptions" TITLE="Choose the options to be supported by the Web application DLL" onClick="onClick(this);" TABINDEX="3">Application Options</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="DevOptions" TITLE="Choose the options that configure the generated projects to the way that you work best" onClick="Next(document, 'DevOptions.htm');" TABINDEX="4">Developer Support Options</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
			
	   	  <!--CLOSE OF NAVIGATIONAL LINKS//-->
		  </TD>
		  <TD WIDTH="1">
		   <DIV CLASS="VERTLINE">
			 <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
		   </DIV>
		  </TD>
		 </TR>
		 </TABLE>
		</TD>
	   </TR>
	   </TABLE>
			
	   <!--CLOSE OF NAVIGATION TABLE//-->
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="100%">
	   <!--OPEN OF CONTENT AND BUTTON TABLE//-->
	   
	   	<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="100%">
		 <TR VALIGN="TOP">
		  <TD HEIGHT="100%">
	   	  <!--OPEN OF CONTENT//-->
		  
		  	<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL WIDTH="193"><COL WIDTH="12"><COL WIDTH="193"><COL WIDTH="12">
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="3">
  				&nbsp;
  			  </TD>
 			 </TR>
 			 <TR>
 			 <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
 				<SPAN CLASS="itemTextTop" ID="generate_app">
	  				 <INPUT CLASS="CheckBox" TYPE="checkbox" ID="GENERATE_APP" ACCESSKEY="a" TITLE="Generates a Web application DLL." onPropertychange="OnGenerateApp();">
	  	 			 <DIV CLASS="itemTextCheckboxA" ID="ITEMTEXTCHECKBOX1_DIV" TITLE="Generates a Web application DLL.">
		  			  <LABEL FOR="GENERATE_APP" ID="GENERATE_APP_LABEL">Generate Web <U>a</U>pplication DLL</LABEL>
	  	 			 </DIV>
				</SPAN>
	
				<P CLASS="ElementSpacer">&nbsp;</P>
					 
				  <SPAN CLASS="itemText" ID="generate_isapi">
	  				 <INPUT CLASS="CheckBox" TYPE="checkbox" ID="GENERATE_ISAPI" ACCESSKEY="i" TITLE="Generates an ISAPI extension DLL." onPropertychange="OnGenerateIsapi();">
	  	 			 <DIV CLASS="itemTextCheckboxA"  ID="ITEMTEXTCHECKBOX2_DIV" TITLE="Generates an ISAPI extension DLL.">
		  			  <LABEL FOR="GENERATE_ISAPI" ID="GENERATE_ISAPI_LABEL" >Generate <U>I</U>SAPI extension DLL</LABEL>
	  	 			 </DIV>
				</SPAN>
	
				<P CLASS="ElementSpacer8">&nbsp;</P>
					 
  				<SPAN CLASS="itemText" TITLE="Specifies the name of the generated ISAPI extension DLL project." ID="isapi_project">
	  	 			 <LABEL CLASS="INDENT" FOR="ISAPI_PROJECT" ID="ISAPI_PROJECT_LABEL">ISAPI <U>p</U>roject name:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnIndent" ID="ISAPI_PROJECT" ACCESSKEY="P" TITLE="Provide a name for the generated ISAPI DLL project." NAME="IsapiProjectName" TYPE="text" VALUE="" onBlur="OnIsapiProject();">
				</SPAN>
	
				<P CLASS="ElementSpacer2">&nbsp;</P>
					 
  				<NOBR>
				 <SPAN CLASS="itemText" TITLE="Specifies the location of the generated ISAPI extension DLL project." ID="isapi_directory">
	  	 			 <LABEL CLASS="INDENT" FOR="ISAPI_DIRECTORY" ID="ISAPI_DIRECTORY_LABEL">ISAPI project <U>d</U>irectory:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtn2Indent" ID="ISAPI_DIRECTORY" ACCESSKEY="d" TITLE="Provide a directory for the generated ISAPI DLL project." NAME="IsapiDirectoryName" TYPE="text" VALUE="" onBlur="OnIsapiDirectory();">
				 </SPAN>
				 &nbsp;&nbsp;&nbsp;
				 <BUTTON CLASS="buttonClass3Indent" ID="BrowseBtn" DISABLED ACCESSKEY="." TYPE="BUTTON" VALUE="Data Source" TITLE="Choose ISAPI directory." onClick="GetIsapiDirectory();">...</BUTTON>
				</NOBR>

				<P CLASS="ElementSpacer2">&nbsp;</P>
					 
				<SPAN CLASS="itemTextIndent" ID="combine_projects">
	  				 <INPUT CLASS="CheckBox" TYPE="checkbox" ID="COMBINE_PROJECTS" ACCESSKEY="m" TITLE="Generates a DLL that combines the Web application and ISAPI extension DLLs into one project and DLL." onPropertychange="OnCombined();">
	  	 			 <DIV CLASS="itemTextCheckboxA"  ID="ITEMTEXTCHECKBOX3_DIV" TITLE="Generates a DLL that combines the Web application and ISAPI extension DLLs into one project and DLL.">
		  			  <LABEL FOR="COMBINE_PROJECTS" ID="COMBINE_PROJECTS_LABEL">Generate co<U>m</U>bined DLL</LABEL>
	  	 			 </DIV>
				</SPAN>
			  </TD>
  
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
			  
			  <TD VALIGN="TOP">
				<SPAN CLASS="itemTextTop">
	  				 <INPUT CLASS="CheckBox" TYPE="checkbox" ID="GENERATE_DEPLOYMENT" ACCESSKEY="y" TITLE="Specifies whether to generate a deployment project containing the information necessary for deploying the other projects generated by this wizard." onPropertychange="OnDeployment();">
	  	 			 <DIV CLASS="itemTextCheckboxA" ID="ITEMTEXTCHECKBOX4_LABEL" TITLE="Create a deployment project for your ATL Server DLL(s).">
		  			  <LABEL FOR="GENERATE_DEPLOYMENT" ID="GENERATE_DEPLOYMENT_LABEL">Deplo<u>y</u>ment support</LABEL>
	  	 			 </DIV>
				</SPAN>
<!--
				<P CLASS="ElementSpacer">&nbsp;</P>
					 
  				<SPAN CLASS="itemText" TITLE="">
					 <LABEL CLASS="INDENT" TITLE="Specify deployment options." ID="SEL_DEPLOY_TEXT" FOR="SEL_DEPLOY">Depl<U>o</U>yment project options:</LABEL>
	  	 			 <BR>
	  	 			 <SELECT CLASS="sideBtnIndent" SIZE="1" ID="SEL_DEPLOY" ACCESSKEY="O" TITLE="Select which deployment project to add to." onPropertychange="OnSelDeploy();">
						<OPTION VALUE="new_proj" SELECTED  ID="NEW_PROJ_OPTION">Create new project</OPTION>
					 </SELECT>
				</SPAN>
-->

<!--	
				<P CLASS="ElementSpacer12">&nbsp;</P>
				
 				<SPAN CLASS="itemText" TITLE="Specifies the name of the Web server on which the deployment project should install the DLLs." ID="isapi_server">
	  	 			 <LABEL CLASS="INDENT" FOR="ISAPI_SERVER" ID="ISAPI_SEVER_LABEL"><U>S</U>erver name:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnIndent" ID="ISAPI_SERVER" ACCESSKEY="s" TITLE="Provide a server for application deployment." NAME="ServerName">
				</SPAN>
-->	
				<P CLASS="ElementSpacer2">&nbsp;</P>
					 
  				<SPAN CLASS="itemText" TITLE="Specifies the name of the virtual root on the Web server to which the deployment project should install the DLLs." ID="isapi_vroot">
	  	 			 <LABEL CLASS="INDENT" FOR="ISAPI_VROOT" ID="ISAPI_VROOT_LABEL"><U>V</U>irtual root:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnIndent" ID="ISAPI_VROOT" ACCESSKEY="v" TITLE="Provide a virtual root to deploy to (this virtual directory must exist on the server, otherwise a default location under wwwroot will be chosen)." NAME="IsapiVRoot">
				</SPAN>
  		  	  </TD>
  
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
		 	</TABLE>
			
	   	  <!--CLOSE OF CONTENT//-->
		  </TD>
		 </TR>
		 <TR VALIGN="BOTTOM">
		  <TD HEIGHT="48">
	   	  <!--OPEN OF BUTTON HTML//-->
		  
		  	<TABLE HEIGHT="48" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="12">
			 <TR>
  			  <TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
				<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
  	 			 <TR VALIGN="TOP">
  	  			  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
  	  			  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
  	 			 </TR>
				</TABLE>
  			  </TD>
 			  </TR>
 
 			  <TR>
  			  <TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			<TR>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" HEIGHT="23">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">Finish</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">Cancel</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="window.external.OnHelp('vc.appwiz.atl.server.objects');">Help</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
			</TABLE>
			
	   	  <!--CLOSE OF BUTTON HTML//-->
		  </TD>
		 </TR>
		</TABLE>
	
  	<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
 	</TD>
  </TR>
</TABLE>

</BODY>
</HTML>

<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Default;
tab_array[1] = AppSettings;
tab_array[2] = ServerOptions;
tab_array[3] = AppOptions;
tab_array[4] = DevOptions;

var bAppended = false;
var bBrowseDlg = false;
var bCanAdd = false;

function InitDocument(document)
{
	setDirection();
	InitTabs();
	window.external.Load(document);
	InitControls();
	
	if (!GENERATE_APP.disabled)
		GENERATE_APP.focus();
		
	else
		COMBINE_PROJECTS.focus();
}

function InitTabs()
{
	MouseOut(ServerOptions);
	MouseOut(AppOptions);
}

function EnableTitles()
{
	isapi_project.disabled = ISAPI_PROJECT.disabled;
	isapi_directory.disabled = ISAPI_DIRECTORY.disabled;
	generate_app.disabled = GENERATE_APP.disabled;
	generate_isapi.disabled = GENERATE_ISAPI.disabled;
//	isapi_server.disabled = ISAPI_SERVER.disabled;
	isapi_vroot.disabled = ISAPI_VROOT.disabled;
	
//	if (SEL_DEPLOY.value == "new_proj")
//		SEL_DEPLOY.disabled = ISAPI_VROOT.disabled;
//		
//	else
//		SEL_DEPLOY.disabled = false;
//		SEL_DEPLOY_TEXT.disabled = false;
		
	combine_projects.disabled = COMBINE_PROJECTS.disabled;
}

/*
function InitDeploymentDropDown()
{
	if ((window.external.dte.Solution.Count == 0) || (window.external.FindSymbol("CLOSE_SOLUTION")))
		return;
		
	var nCnt = 1;
	var nOpt = 1;
	
	var L_ADDTO_Text = "Add to ";
	
	var strSelect = window.external.FindSymbol("SEL_DEPLOY_");
	
	for (nCnt = 1; nCnt <= window.external.dte.Solution.Count; nCnt++)
	{
		var obj = window.external.dte.Solution.Item(nCnt).Object;
		if (obj != null && window.external.IsWebTierProject(obj))
		{
			var oOption = document.createElement("OPTION");
			oOption.value = nCnt.toString();
			oOption.text = L_ADDTO_Text + window.external.dte.Solution.Item(nCnt).Name;
			oOption.toString();
			SEL_DEPLOY.add(oOption, nOpt);
			nOpt++;
		}
	}
	
	SEL_DEPLOY.value = strSelect;
}
*/

function InitControls()
{
	ISAPI_PROJECT.disabled = false;
	ISAPI_DIRECTORY.disabled = false;
	COMBINE_PROJECTS.disabled = true;
//	InitDeploymentDropDown();
//	SEL_DEPLOY.disabled = true;
//	SEL_DEPLOY_TEXT.disabled = true;
	
	if (window.external.FindSymbol("COMBINE_PROJECTS"))
	{
		window.external.AddSymbol("GENERATE_ISAPI", true);
		window.external.AddSymbol("GENERATE_APP", true);
		ISAPI_PROJECT.disabled = true;
		ISAPI_DIRECTORY.disabled = true;
		GENERATE_ISAPI.disabled = true;
		GENERATE_APP.disabled = true;
	}
	
	GENERATE_ISAPI.checked = window.external.FindSymbol("GENERATE_ISAPI");
	GENERATE_APP.checked = window.external.FindSymbol("GENERATE_APP");

	if (!GENERATE_ISAPI.checked)
	{
		ISAPI_PROJECT.disabled = true;
		ISAPI_DIRECTORY.disabled = true;
	}
	if ((GENERATE_APP.checked && GENERATE_ISAPI.checked) || window.external.FindSymbol("COMBINE_PROJECTS"))
		COMBINE_PROJECTS.disabled = false;

	EnableTitles();
	OnGenerateApp();
	OnGenerateIsapi();
	OnIsapiProject();
	OnIsapiDirectory();
	MouseOut(BrowseBtn);
	bCanAdd = true;
}

function Next(document, linkto)
{
	if (ValidateInput())
		window.external.Next(document, linkto);
}

function OnFinish(document)
{
	if (!ValidateInput())
		return;

	OnWizFinish(document);
}

function onClick(obj)
{
	if (obj.id == "ServerOptions")
	{
		if (GENERATE_ISAPI.checked || COMBINE_PROJECTS.checked) 
		{ 
			if (!ValidateInput())
				return;

			Next(document, "ServerOptions.htm"); 
		}
	}
	else if (obj.id == "AppOptions")
	{
		if (GENERATE_APP.checked || COMBINE_PROJECTS.checked)
		{
			if (!ValidateInput())
				return;

			Next(document, "AppOptions.htm");
		}
	}
}

function IsLetter(ch)
{
	if (ch >= 'a' && ch <= 'z')
		return true;
	if (ch >= 'A' && ch <= 'Z')
		return true;
	return false;
}

function IsNumber(ch)
{
	if (ch >= '0' && ch <= '9')
		return true;
	return false;
}

function IsValidDirectory(strDirectory)
{
	if (strDirectory.length < 3)
		return false;

	if (IsLetter(strDirectory.charAt(0)) && strDirectory.charAt(1) == ':' && strDirectory.charAt(2) == '\\')
		return true;

	if (strDirectory.charAt(0)=='\\' && strDirectory.charAt(1)=='\\' &&
	    (IsLetter(strDirectory.charAt(2)) || IsNumber(strDirectory.charAt(2))))
		return true;
	
	return false;
}

function CheckValidUrlString(strValue, strErrPrefix, bServer)
{
	var nLen = strValue.length;
	var strErrString;
	for (nCntr = 0; nCntr < nLen; nCntr++)
	{
		var cChar = strValue.charAt(nCntr);
		switch(cChar)
		{
			case " ":
			case "~":
			case "&":
			case "'":
			case "#":
			case "!":
			case "@":
			case "$":
			case "%":
			case "^":
			case "(":
			case ")":
			case "+":
			case "=":
			case "{":
			case "}":
			case "[":
			case "]":
			case ";":
			case ",":
			case "`":
			case ".":
			case "*":
			case "\\":
				{
					L_Err1_Text = " contains invalid characters: '";
					window.external.ReportError(strErrPrefix + L_Err1_Text + cChar + "'");
					return false;
				}
				break;
			case "/":
				if (bServer)
				{
					L_Err2_Text = " contains invalid characters: '";
					window.external.ReportError(strErrPrefix + L_Err2_Text + cChar + "'");
					return false;
				}
				break;
			case "-":
				if (!bServer)
				{
					L_Err3_Text = " contains invalid characters: '";
					window.external.ReportError(strErrPrefix + L_Err3_Text + cChar + "'");
					return false;
					break;
				}
			default:
				break;
		}
	}
	
	return true;
}

function ValidateVRoot(strValue)
{
	if (strValue == "")
	{
		L_Err4_Text = "Virtual directory cannot be empty.";
		window.external.ReportError(L_Err4_Text);
		return false;
	}
	else if (strValue.charAt(0) == '\\' || strValue.charAt(0) == '/')
	{
		L_Err5_Text = "Virtual directory cannot start with a \\ or a /.";
		window.external.ReportError(L_Err5_Text);
		return false;
	}

	L_Err9_Text = "Virtual directory";	
	if (!CheckValidUrlString(strValue, L_Err9_Text, false))
		return false;
	
	return true;
}

function ValidateServer(strValue)
{
	if (strValue == "")
	{
		L_Err6_Text = "Server name cannot be empty.";
		window.external.ReportError(L_Err6_Text);
		return false;
	}
	if (strValue.charAt(0) == '\\' || strValue.charAt(0) == '/')
	{
		L_Err7_Text = "Server name cannot start with a \\ or a /.";
		window.external.ReportError(L_Err7_Text);
		return false;
	}
	
	L_Err10_Text = "Server name";
	if (!CheckValidUrlString(strValue, L_Err10_Text, true))
		return false;
		
	return true;
}

function ValidateInput()
{
	var oInvalid = null;
	if (GENERATE_DEPLOYMENT.checked == true)
	{
		var strValue = ISAPI_VROOT.value;
		if (!ValidateVRoot(strValue))
		{
			oInvalid = ISAPI_VROOT;
		}

/*		
		if (oInvalid == null)
		{
			strValue = ISAPI_SERVER.value;
			if (!ValidateServer(strValue))
			{
				oInvalid = ISAPI_SERVER;
			}
		}
*/
	}
	
	if (oInvalid == null && GENERATE_ISAPI.checked==true && GENERATE_ISAPI.disabled==false)
	{
		if (!IsValidDirectory(TrimStr(ISAPI_DIRECTORY.value)))
			//ISAPI_DIRECTORY.value.length == 0)
			oInvalid = ISAPI_DIRECTORY;
		else if (ISAPI_PROJECT.value.length == 0)
			oInvalid = ISAPI_PROJECT;
		
		if (oInvalid == null)
		{
			var strIsapiPath = window.external.FindSymbol("ISAPI_DIRECTORY");
			var strIsapiProjectPath = strIsapiPath + "\\" + window.external.FindSymbol("ISAPI_PROJECT");
			var strFullIsapiPath = strIsapiPath + "\\" + window.external.FindSymbol("ISAPI_PROJECT")+ "\\" + window.external.FindSymbol("ISAPI_PROJECT")+".vcproj";
			
			if (!window.external.dte.VCLanguageManager.ValidateFileName(strFullIsapiPath, vsCMValidateFileExtNone))
			{
				window.external.ReportError();
				oInvalid = ISAPI_PROJECT;
				oInvalid.focus();
				return false;
			}
			
			try
			{
				var bCreateSolution = false;
				if (GENERATE_APP.checked == false && COMBINE_PROJECTS.checked == false)
					bCreateSolution = true;
				if (window.external.CanCreateNewProjectAtLocation(bCreateSolution, strFullIsapiPath, true)==false)
				{
					oInvalid = ISAPI_DIRECTORY;
				}
				
				if (oInvalid == null && GENERATE_APP.checked == true)
				{
					if (strIsapiProjectPath == window.external.FindSymbol("PROJECT_PATH"))
					{
						oInvalid = ISAPI_PROJECT;
					}
				}
			}
			catch(e)
			{
				oInvalid = ISAPI_DIRECTORY;
			}
		}
		if (oInvalid != null)
		{
			L_Err8_Text = "Cannot create ISAPI project at specified location.";
			window.external.ReportError(L_Err8_Text);
			oInvalid.focus();
			return false;
		}
	}
	
	if (oInvalid != null)
	{
		oInvalid.focus();
		return false;
	}
	return true;
}

function OnDeployment()
{
//	ISAPI_SERVER.disabled = true;
	ISAPI_VROOT.disabled = true;
//	SEL_DEPLOY.disabled = true;
//	SEL_DEPLOY_TEXT.disabled = true;
	
	window.external.AddSymbol("GENERATE_DEPLOYMENT", GENERATE_DEPLOYMENT.checked);
	if (GENERATE_DEPLOYMENT.checked)
	{
//		ISAPI_SERVER.disabled = false;
		ISAPI_VROOT.disabled = false;
//		SEL_DEPLOY.disabled = false;
//		SEL_DEPLOY_TEXT.disabled = false;
	}
	
//	isapi_server.disabled = ISAPI_SERVER.disabled;
	isapi_vroot.disabled = ISAPI_VROOT.disabled;
}

function OnSelectUrl()
{
	//var strUrl = window.external.GetURLViaDlg("ATL Server Deployment", "Deployment URL");
	//window.external.AddSymbol("DEPLOYMENT_URL", strUrl);
}

function OnGenerateIsapi()
{
	window.external.AddSymbol("GENERATE_ISAPI", GENERATE_ISAPI.checked);
	
	if (!GENERATE_ISAPI.checked)
	{
		ISAPI_PROJECT.disabled = true;
		ISAPI_DIRECTORY.disabled = true;

		if (GENERATE_APP.checked)
		{
			COMBINE_PROJECTS.disabled = false;
			combine_projects.disabled = false;
		}
		else
		{
			GENERATE_APP.checked = true;
		}
	}
	else if (!GENERATE_ISAPI.disabled)
	{
		ISAPI_PROJECT.disabled = false;
		ISAPI_DIRECTORY.disabled = false;
		
		if (window.external.FindSymbol("_FIRST_SWITCH")==false && window.external.FindSymbol("GENERATE_APP")==false)
		{
			window.external.AddSymbol("_FIRST_SWITCH", true);
			var strPath = window.external.FindSymbol("PROJECT_PATH");
			var nIndex = strPath.lastIndexOf("\\");
			var strProjectDir = strPath.substring(0, nIndex);
			var strProjectName = window.external.FindSymbol("PROJECT_NAME");
			
			ISAPI_DIRECTORY.value = strProjectDir;
			ISAPI_PROJECT.value = strProjectName;
			
			OnIsapiProject();
			OnIsapiDirectory();
		}
	}
	
	if (GENERATE_ISAPI.checked && GENERATE_APP.checked)
		COMBINE_PROJECTS.disabled = false;
	else if (!window.external.FindSymbol("COMBINE_PROJECTS"))
		COMBINE_PROJECTS.disabled = true;
	
	EnableTitles();
	
	InitTabs();
	MouseOut(BrowseBtn);
}

function OnGenerateApp()
{
	window.external.AddSymbol("GENERATE_APP", GENERATE_APP.checked);
	if (!GENERATE_APP.checked)
	{
		if (!GENERATE_ISAPI.checked)
		{
			GENERATE_ISAPI.checked = true;
			ISAPI_PROJECT.disabled = false;
			ISAPI_DIRECTORY.disabled = false;
		}
	}
	else
	{
		var strIsapiPath = window.external.FindSymbol("ISAPI_DIRECTORY");
		var strIsapiProjectPath = strIsapiPath + "\\" + window.external.FindSymbol("ISAPI_PROJECT");
		if (strIsapiProjectPath == window.external.FindSymbol("PROJECT_PATH"))
		{
			ISAPI_DIRECTORY.value = window.external.FindSymbol("_ISAPI_DIRECTORY");
			ISAPI_PROJECT.value = window.external.FindSymbol("_ISAPI_PROJECT");
			OnIsapiProject();
			OnIsapiDirectory();
		}
	}
	
	if (GENERATE_ISAPI.checked && GENERATE_APP.checked)
		COMBINE_PROJECTS.disabled = false;
	else if (!window.external.FindSymbol("COMBINE_PROJECTS"))
		COMBINE_PROJECTS.disabled = true;
	
	EnableTitles();
	InitTabs();
}

function OnCombined()
{
	window.external.AddSymbol("COMBINE_PROJECTS", COMBINE_PROJECTS.checked);
	if (COMBINE_PROJECTS.checked)
	{
		GENERATE_APP.disabled = true;
		GENERATE_ISAPI.disabled = true;
		ISAPI_PROJECT.disabled = true;
		ISAPI_DIRECTORY.disabled = true;
	}
	else
	{
		GENERATE_APP.disabled = false;
		GENERATE_ISAPI.disabled = false;
	}
	EnableTitles();
	InitTabs();
	MouseOut(BrowseBtn);
}

function GetIsapiDirectory()
{
	if (GENERATE_ISAPI.checked && GENERATE_ISAPI.disabled==false)
	{
		bBrowseDlg = true;
		try
		{
			var L_ChooseISAPIDirectory_Text = "Choose ISAPI Directory";
			var strDirectory = window.external.GetDirectoryViaBrowseDlg(L_ChooseISAPIDirectory_Text, "");
			if (strDirectory != "")
			{
				if (strDirectory.charAt(strDirectory.length-1)=='\\')
				{
					if (strDirectory.charAt(strDirectory.length-2) != ':')
						strDirectory = strDirectory.substring(0, strDirectory.length-1);
				}
				
				ISAPI_DIRECTORY.value = strDirectory;
				window.external.AddSymbol("ISAPI_DIRECTORY", strDirectory);
			}
		}
		catch(e)
		{
		}
		bBrowseDlg = false;
	}
}

function OnIsapiProject()
{
	var str = TrimStr(ISAPI_PROJECT.value);
	window.external.AddSymbol("ISAPI_PROJECT", str);
}

function OnIsapiDirectory()
{
	var str = TrimStr(ISAPI_DIRECTORY.value);
	window.external.AddSymbol("ISAPI_DIRECTORY", str);
}

/*
function OnSelDeploy()
{
	ISAPI_VROOT.disabled = false;
	if (SEL_DEPLOY.value != "new_proj")
	{
		ISAPI_VROOT.disabled = true;
	}
	window.external.AddSymbol("SEL_DEPLOY", SEL_DEPLOY.value);
	if (bCanAdd == true)
		window.external.AddSymbol("SEL_DEPLOY_", SEL_DEPLOY.value);
	ISAPI_SERVER.disabled = ISAPI_VROOT.disabled;
	isapi_vroot.disabled = ISAPI_VROOT.disabled;
	isapi_server.disabled = ISAPI_VROOT.disabled;
}
*/

</SCRIPT>
<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT>
	var strPath = "../../../";
	strPath += window.external.GetHostLocale();
	var strScriptPath = strPath + "/Script.js";
	var strCommonPath = strPath + "/Common.js";
	document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
	document.scripts("INCLUDE_COMMON").src = strCommonPath;
</SCRIPT>