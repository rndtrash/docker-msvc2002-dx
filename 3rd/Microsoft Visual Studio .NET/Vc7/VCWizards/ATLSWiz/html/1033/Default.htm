<!- (c) 2001 Microsoft Corporation -->
<HTML DIR="LTR">

<HEAD>
	<TITLE>ATL Server Project Wizard</TITLE>
	<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
	<STYLE TYPE="text/css">@import url();</STYLE>
	<SCRIPT>
		var strURL = "../../../";
		strURL += window.external.GetHostLocale();
		strURL += "/NewStyles.css";
		document.styleSheets(0).imports(0).href = strURL;
	</SCRIPT>

	<SYMBOL NAME="SAFE_PROJECT_NAME" TYPE="text"></SYMBOL>

	<SYMBOL NAME="GENERATE_ISAPI" TYPE="radio" VALUE="false"></SYMBOL>
	<SYMBOL NAME="GENERATE_DEPLOYMENT" TYPE="checkbox" VALUE="true"></SYMBOL>
	<SYMBOL NAME="ISAPI_CLASS" TYPE="text"></SYMBOL>
	<SYMBOL NAME="ISAPI_FILE" TYPE="text"></SYMBOL>
	<SYMBOL NAME="ISAPI_VROOT" TYPE="text"></SYMBOL>   
	<SYMBOL NAME="ISAPI_PROJECT" TYPE="text"></SYMBOL>
	<SYMBOL NAME="ISAPI_DIRECTORY" TYPE="text"></SYMBOL>

	<SYMBOL NAME="GENERATE_APP" TYPE="radio" VALUE="true"></SYMBOL>
	<SYMBOL NAME="APP_CLASS" TYPE="text"></SYMBOL>
	<SYMBOL NAME="APP_FILE" TYPE="text"></SYMBOL>
	<SYMBOL NAME="APP_PROJECT" TYPE="text"></SYMBOL>
	<SYMBOL NAME="APP_DIRECTORY" TYPE="text"></SYMBOL>

	<SYMBOL NAME="EXTENSION_CLASS" TYPE="text"></SYMBOL>
	<SYMBOL NAME="EXTENSION_FILE" TYPE="text"></SYMBOL>
		
	<SYMBOL NAME="SRF_CLASS" TYPE="text"></SYMBOL>
	<SYMBOL NAME="SRF_FILE" TYPE="text"></SYMBOL>

	<SYMBOL NAME="COMBINE_PROJECTS" TYPE="radio" VALUE="false"></SYMBOL>

	<SYMBOL NAME="TEST_SERVICE" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="SERVICE_NONE" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="FILE_CACHE" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="BLOB_CACHE" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="ATTRIBUTED" TYPE="checkbox" VALUE="true"></SYMBOL>
	<SYMBOL NAME="TODO" TYPE="checkbox" VALUE="true"></SYMBOL>
	<SYMBOL NAME="VALIDATION" TYPE="checkbox" VALUE="true"></SYMBOL>
	<SYMBOL NAME="STENCIL" TYPE="checkbox" VALUE="true"></SYMBOL>
	<SYMBOL NAME="PERFMON" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="WEBDBG" TYPE="checkbox" VALUE="true"></SYMBOL>
	<SYMBOL NAME="SOME_SESSION" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="SESSION_DB" TYPE="radio" VALUE="true"></SYMBOL>
	<SYMBOL NAME="SESSION_MEM" TYPE="radio" VALUE="false"></SYMBOL>
	<SYMBOL NAME="ROWSET_CLASS" TYPE="text" VALUE=""></SYMBOL>
	<SYMBOL NAME="DB_CONNECTION_STRING" TYPE="text" VALUE=""></SYMBOL>
	<SYMBOL NAME="DB_TABLE" TYPE="text" VALUE=""></SYMBOL>
	<SYMBOL NAME="DB_SCHEMA" TYPE="text" VALUE=""></SYMBOL>
	<SYMBOL NAME="DB_STORED_PROCEDURE" TYPE="bool" VALUE="false"></SYMBOL>
	<SYMBOL NAME="DATASOURCE_CACHE" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="SOAP" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="USELOCALE" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="LOCALE" TYPE="text" VALUE=""></SYMBOL>
	<SYMBOL NAME="USECODEPAGE" TYPE="checkbox" VALUE="false"></SYMBOL>
	<SYMBOL NAME="CODEPAGE" TYPE="text" VALUE=""></SYMBOL>
	<SYMBOL NAME="BROWSCAPS" TYPE="checkbox" VALUE="false"></SYMBOL>
		
	<SYMBOL NAME="COMPANY_NAME" TYPE="text" VALUE=""></SYMBOL>
	<SYMBOL NAME="YEAR" TYPE="text" VALUE=""></SYMBOL>

	<SYMBOL NAME="SOURCE_FILTER" TYPE="text"></SYMBOL>
	<SYMBOL NAME="INCLUDE_FILTER" TYPE="text"></SYMBOL>
	<SYMBOL NAME="RESOURCE_FILTER" TYPE="text"></SYMBOL>

	<SYMBOL NAME="HELP_PATH" TYPE="text" VALUE="hlp"></SYMBOL>
	<SYMBOL NAME="RES_PATH" TYPE="text" VALUE="res"></SYMBOL>

	<SYMBOL NAME="LANGUAGE" TYPE=select-one></SYMBOL>
	<SYMBOL NAME="LANGUAGE_NAME" TYPE=text></SYMBOL>
	<SYMBOL NAME="LCID" TYPE=select-one></SYMBOL>
	<SYMBOL NAME="HEX_LCID" TYPE=text></SYMBOL>
	<SYMBOL NAME="CODE_PAGE" TYPE=text VALUE="1252"></SYMBOL>
	<SYMBOL NAME="HEX_CODE_PAGE" TYPE=text VALUE="4E4"></SYMBOL>
	<SYMBOL NAME="PRIMARY_LANG_ID" TYPE=text VALUE="9"></SYMBOL>
	<SYMBOL NAME="SUB_LANG_ID" TYPE=text VALUE="1"></SYMBOL>
	<SYMBOL NAME="LANG_SUFFIX" TYPE=text VALUE="ENU"></SYMBOL>
</HEAD>

<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="if (!bValidating) OnKey();" ONKEYPRESS="if (!bValidating) OnPress();">

<TABLE CLASS="ONE" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<COL WIDTH="178"><COL>

  <!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
  <TR VALIGN="TOP">
	<TD HEIGHT="79" WIDTH="100%" COLSPAN="2">
	 <TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
	 <COL WIDTH="12"><COL><COL WIDTH="12">
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
		<DIV CLASS="SMALLA" ID="Layer0">
		 <IMG CLASS="SMALLEST" SRC="../../Images/ATL_Server_1.gif" WIDTH="63" HEIGHT="63" ALT="" BORDER="0">
		</DIV>
	   </TD>

	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65">
		<H4 CLASS="HEAD" ID="HEAD">Welcome to the ATL Server Project Wizard</H4>
		<P CLASS="SUBHEAD" ID="SUBHEAD">This wizard provides an easy way to generate Web application or XML Web Service projects that use ATL Server.</P>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
		<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
	  	 <TR VALIGN="TOP">
	  	  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
	  	  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
	  	 </TR>
		</TABLE>
	   </TD>
	  </TR>
	 </TABLE>
	</TD>
  </TR>
  <!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->

  <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
  <TR VALIGN="TOP">
	<TD CLASS="Three" VALIGN="TOP" HEIGHT="100%" WIDTH="178">
	 <TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="178" BORDER="0" CELLPADDING="0" CELLSPACING="0">
  	  <TR VALIGN="TOP">
	   <TD CLASS="threeCustom" VALIGN="TOP" STYLE="BACKGROUND-IMAGE: URL(../../Images/ATL_Server_Background.gif);">
	   	<!--OPEN OF NAVIGATION TABLE//-->

	    <TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="12"><COL WIDTH="166"><COL WIDTH="1">
		 <TR>
	   	  <TD VALIGN="TOP" COLSPAN="3" HEIGHT="12">
	  		&nbsp;
		  </TD>
		 </TR>
		 <TR>
	   	  <TD VALIGN="TOP" HEIGHT="100%" WIDTH="12">
	  		&nbsp;
		  </TD>
	   	  <TD VALIGN="TOP" HEIGHT="100%" WIDTH="165">
	   	  <!--OPEN OF NAVIGATIONAL LINKS//-->

		  	<DIV CLASS="LINKSELECTED">
	 	   	 <SPAN CLASS="VERTLINE1">
			  <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
			 </SPAN>
			 <SPAN CLASS="HORILINE1">
			  <TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
				</TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD HEIGHT="100%">
				 <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="28" ALT="" BORDER="0">
			    </TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
			    </TD>
			   </TR>
			  </TABLE>
			 </SPAN>
			 <TABLE WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTSELECTED">
			  <TR VALIGN="MIDDLE">
			   <TD WIDTH="156">
				<SPAN ID="Default" TITLE="Examine an overview of selections">Overview</SPAN>
			   </TD>
			   <TD WIDTH="4">
				<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="AppSettings" TITLE="Choose the project types to be generated along with their names and locations" onClick="Next(document, 'AppSettings.htm');" TABINDEX="1">Project Settings</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTINDENT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="ServerOptions" TITLE="Choose the options to be supported by the ISAPI extension DLL" onClick="onClick(this);" TABINDEX="2">Server Options</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTINDENT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="AppOptions" TITLE="Choose the options to be supported by the Web application DLL" onClick="onClick(this);" TABINDEX="3">Application Options</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="DevOptions" TITLE="Choose the options that configure the generated projects to the way that you work best" onClick="Next(document, 'DevOptions.htm');" TABINDEX="4">Developer Support Options</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
			
	   	  <!--CLOSE OF NAVIGATIONAL LINKS//-->
		  </TD>
		  <TD WIDTH="1">
		   <DIV CLASS="VERTLINE">
			 <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
		   </DIV>
		  </TD>
		 </TR>
		 </TABLE>
		</TD>
	   </TR>
	   </TABLE>
			
	   <!--CLOSE OF NAVIGATION TABLE//-->
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="100%">
	   <!--OPEN OF CONTENT AND BUTTON TABLE//-->
	   
	   	<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="100%">
		 <TR VALIGN="TOP">
		  <TD HEIGHT="100%">
	   	  <!--OPEN OF CONTENT//-->
		  
		  	<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL WIDTH="398"><COL WIDTH="12">
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="3">
  				&nbsp;
  			  </TD>
 			 </TR>
 			 <TR>
 			 <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
 				<SPAN CLASS="ItemTextTop" ID="CURRENT_SETTINGS_SPAN">These are the current project settings:</SPAN>
				
					<UL>
	  	 			 <LI CLASS="LIST">
		  			  <SPAN CLASS="SideBtnHidden" ID="APPTYPE" TITLE="">	
		   				<LABEL FOR="APPTYPE"></LABEL>
		  			  </SPAN>
	  	 			 </LI>
	  	 			 <LI CLASS="LIST">
		  			  <SPAN CLASS="SideBtnHidden" ID="ATTRIBUTEDAPP" TITLE="">
		   				<LABEL FOR="ATTRIBUTEDAPP"></LABEL>
		  			  </SPAN>
	  	 			 </LI>
	  	 			 <LI CLASS="LIST">
		  			  <SPAN CLASS="SideBtnHidden" ID="DEPLOYMENT" TITLE="">
		   				<LABEL FOR="DEPLOYMENT"></LABEL>
		  			  </SPAN>
	  	 			 </LI>
	  	 			 <LI CLASS="LIST">
		  			  <SPAN CLASS="SideBtnHidden" ID="GENTODO" TITLE="">
		   				<LABEL FOR="GENTODO"></LABEL>
		  			  </SPAN>
	  	 			 </LI>
	  	 			 <LI CLASS="LIST">
		  			  <SPAN CLASS="SideBtnHidden" ID="WEBDBGOPT" TITLE="">
		   				<LABEL FOR="WEBDBGOPT"></LABEL>
		  			  </SPAN>
	  	 			 </LI>
	  	 			 <LI CLASS="LIST">
		  			  <SPAN CLASS="SideBtnHidden" ID="STENCILSUPPORT" TITLE="">
		   				<LABEL FOR="STENCILSUPPORT"></LABEL>
		  			  </SPAN>
	  	 			 </LI>
	  	 			 <LI CLASS="LIST">
		  			  <SPAN CLASS="SideBtnHidden" ID="VALIDSUPPORT" TITLE="">
		   				<LABEL FOR="VALIDSUPPORT"></LABEL>
		  			  </SPAN>
	  	 			 </LI>
					  <SPAN CLASS="SideBtnHidden" ID="RESERVED1" TITLE="">
		   				<LABEL FOR="RESERVED1"></LABEL>
		  			  </SPAN>
					  <SPAN CLASS="SideBtnHidden" ID="RESERVED2" TITLE="">
		   				<LABEL FOR="RESERVED2"></LABEL>
		  			  </SPAN>
				</UL>
	  				
				<SPAN CLASS="ItemText" ID="FinishText">Click <B>Finish</B> from any window to accept the current settings.</SPAN>
	
				<P CLASS="ElementSpacer2">&nbsp;</P>
					 
              	<SPAN CLASS="ItemText" ID="README_REMINDER" TITLE="">After you create the project, see the project's readme.txt file for information about the project features and files that are generated.</SPAN>
  		  	  </TD>
  
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
		 	</TABLE>
			
	   	  <!--CLOSE OF CONTENT//-->
		  </TD>
		 </TR>
		 <TR VALIGN="BOTTOM">
		  <TD HEIGHT="48">
	   	  <!--OPEN OF BUTTON HTML//-->
		  
		  	<TABLE HEIGHT="48" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="12">
			 <TR>
  			  <TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
				<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
  	 			 <TR VALIGN="TOP">
  	  			  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
  	  			  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
  	 			 </TR>
				</TABLE>
  			  </TD>
 			  </TR>
 
 			  <TR>
  			  <TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			<TR>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" HEIGHT="23">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">Finish</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">Cancel</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="window.external.OnHelp('vc.appwiz.atl.server.overview');">Help</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
			</TABLE>
			
	   	  <!--CLOSE OF BUTTON HTML//-->
		  </TD>
		 </TR>
		</TABLE>
	
  	<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
 	</TD>
  </TR>
</TABLE>

</BODY>
</HTML>

<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Default;
tab_array[1] = AppSettings;
tab_array[2] = ServerOptions;
tab_array[3] = AppOptions;
tab_array[4] = DevOptions;

function CreateSafeAtlsName(strName)
{
	var nLen = strName.length;
	var strSafeName = "";
	for (nCntr = 0; nCntr < nLen; nCntr++)
	{
		var cChar = strName.charAt(nCntr);
		switch(cChar)
		{
			case " ":
			case "~":
			case "&":
			case "'":
			case "#":
			case "!":
			case "@":
			case "$":
			case "%":
			case "^":
			case "(":
			case ")":
			case "-":
			case "+":
			case "=":
			case "{":
			case "}":
			case "[":
			case "]":
			case ";":
			case ",":
			case "`":
			case ".":
				strSafeName += "_";
				break;
			default:
				strSafeName += cChar;
				break;
		}
	}
	return strSafeName;
}

function GetDefaultLCID()
{
	var strLCID = window.external.FindSymbol("LCID");

	var strInstalledLangs = window.external.GetInstalledLangs();
	var len = strInstalledLangs.length;
	var strLangId = "";
	
	// Populate the list
	//
	for (i = 0; i < len; i++)
	{
		var strNext = strInstalledLangs.substr(i,1);
		if (strNext == ",")
		{
			if (strLCID == strLangId)
				return strLCID;

			strLangId = "";
			continue;
		}
		strLangId += strNext;
	}
	
	if (strLCID == strLangId)
		return strLCID;

	return "1033"; // default to english if no resources are available for the default locale
}

function InitDocument(document)
{
	setDirection();

	if (window.external.FindSymbol("DOCUMENT_FIRST_LOAD"))
	{
		var L_WizardDialogTitle_Text = "ATL Server Project Wizard";
		window.external.AddSymbol("WIZARD_DIALOG_TITLE", L_WizardDialogTitle_Text);
		window.external.AddSymbol("_SOAP_CHECKED", false);
		window.external.AddSymbol("_STENCIL_CHECKED", false);
		window.external.AddSymbol("_DS_CHECKED", false);
		window.external.AddSymbol("_FIRST_SWITCH", false);
		var strProjName = window.external.FindSymbol("PROJECT_NAME");
		var coll = document.all.tags("SYMBOL");
		var numSymbols = coll.length;
		for (i = 0; i < numSymbols; i++)
		{
			var obj = coll(i);
			if (typeof(obj.VALUE) == "undefined")
			{
				obj.VALUE = getval(obj, strProjName);
			}
		}
		window.external.SetDefaults(document);
		
		var strLCID = GetDefaultLCID();
	
		// fix up the templates path for the locale
		var strCurrentTemplatesPath = window.external.FindSymbol("TEMPLATES_PATH");
		var nIndex = strCurrentTemplatesPath.lastIndexOf("\\");
		var strSubstr = strCurrentTemplatesPath.substr(0, nIndex);
		var strNewTemplatesPath = strSubstr + "\\" + strLCID;
		window.external.AddSymbol("TEMPLATES_PATH", strNewTemplatesPath);
	
		var strSysLcid = window.external.GetSystemLCID();
		var strCodePage = window.external.GetCodePageFromLCID(strSysLcid);
		window.external.AddSymbol("CODE_PAGE", strCodePage);
		window.external.AddSymbol("PRIMARY_LANG_ID", window.external.GetPrimaryLangIdFromLCID(strSysLcid));
		window.external.AddSymbol("SUB_LANG_ID", window.external.GetSubLangIdFromLCID(strSysLcid));
		window.external.AddSymbol("LANG_SUFFIX", window.external.GetLangAbbrevFromLCID(strLCID));
		window.external.AddSymbol("IS_ENGLISH", (strLCID == "1033"));

		var strPath = window.external.FindSymbol("PROJECT_PATH");
		var nIndex = strPath.lastIndexOf(window.external.FindSymbol("SAFE_PROJECT_NAME"));
		if (nIndex == -1)
			nIndex = strPath.length;
		else
			nIndex -= 1;
			
		if (nIndex > 0)
		{
			var strIsapiPath = strPath.substring(0, nIndex);
			if (strIsapiPath.charAt(strIsapiPath.length-1) == ':')
				strIsapiPath += "\\";
			var strFullIsapiPath = strIsapiPath + "\\" + window.external.FindSymbol("PROJECT_NAME")+"Isapi\\"+ window.external.FindSymbol("PROJECT_NAME")+"Isapi";
			try
			{
				var strCreatePath = strFullIsapiPath;
				
				var bCanCreate = window.external.CanCreateNewProjectAtLocation(window.external.FindSymbol("CLOSE_SOLUTION"), strCreatePath+".vcproj", true);
				if (bCanCreate != false)
				{
					window.external.AddSymbol("ISAPI_PROJECT", window.external.FindSymbol("PROJECT_NAME")+"Isapi");
					window.external.AddSymbol("ISAPI_PROJECT", window.external.FindSymbol("ISAPI_PROJECT"));
					window.external.AddSymbol("ISAPI_DIRECTORY", strIsapiPath);
					window.external.AddSymbol("_ISAPI_PROJECT", window.external.FindSymbol("ISAPI_PROJECT"));
					window.external.AddSymbol("_ISAPI_DIRECTORY", window.external.FindSymbol("ISAPI_DIRECTORY"));
				}
				else
				{					
					window.external.AddSymbol("ISAPI_PROJECT", "");
					window.external.AddSymbol("ISAPI_PROJECT", "");
					window.external.AddSymbol("ISAPI_DIRECTORY", "");
					window.external.AddSymbol("_ISAPI_PROJECT", "");
					window.external.AddSymbol("_ISAPI_DIRECTORY", "");
					
					var L_ErrMsg1_Text = "Could not create default directory and project name for ISAPI project.\nPlease specify a directory and project name for your ISAPI project on the Project Settings tab of the wizard.";
					window.external.ReportError(L_ErrMsg1_Text);
				}
			}
			catch(e)
			{
				if (e.number == OLE_E_PROMPTSAVECANCELLED)
					window.external.Finish(document, 'cancel');
			}
		}
		
		if ((window.external.dte.Solution.Count == 0) || (window.external.FindSymbol("CLOSE_SOLUTION")))
		{
			window.external.AddSymbol("GENERATE_ISAPI", true);
		}
		
		if (window.external.FindSymbol("SOAP_WIZ") == "DoSoapWiz")
		{
			window.external.AddSymbol("SOAP", true);
			window.external.AddSymbol("_SOAP_CHECKED", true);
			window.external.AddSymbol("_STENCIL", true);
			window.external.AddSymbol("STENCIL", false);
			window.external.AddSymbol("_VALIDATION", true);
			window.external.AddSymbol("VALIDATION", false);
			window.external.AddSymbol("_USELOCALE", false);
			window.external.AddSymbol("USELOCALE", false);
			window.external.AddSymbol("_USECODEPAGE", false);
			window.external.AddSymbol("USECODEPAGE", false);
			window.external.AddSymbol("_ATTRIBUTED", true);
			window.external.AddSymbol("ATTRIBUTED", true);
			window.external.AddSymbol("APP_CLASS", window.external.FindSymbol("SAFE_PROJECT_NAME") + "Service");
		}
	}
	
	InitTabs();
	window.external.Load(document);
	InitControls();
	FinishBtn.focus();
}

function InitTabs()
{
	MouseOut(ServerOptions);
	MouseOut(AppOptions);
}

function InitControls()
{
	var bApp = window.external.FindSymbol("GENERATE_APP");
	var bIsapi = window.external.FindSymbol("GENERATE_ISAPI");
	var bCombined = window.external.FindSymbol("COMBINE_PROJECTS");
	
	// App Type strings
	var L_APPTYPE_TEXT = ""; 
	var L_WEBSERVICE_TEXT = "Web Service";
	var L_WEBAPP_TEXT = "Web application";
	var L_DLL_TEXT = " DLL";
	var L_COMMA_TEXT = ", ";
	var L_ISAPI_TEXT = "ISAPI extension";
	var L_COMBINED_TEXT = " in combined DLL";

	if (bCombined)
	{
		bApp = true;
		bIsapi = true;
	}
	if (bApp)
	{
		if (window.external.FindSymbol("SOAP"))
			L_APPTYPE_TEXT += L_WEBSERVICE_TEXT;
		else
			L_APPTYPE_TEXT += L_WEBAPP_TEXT;
		if (!bCombined)
			L_APPTYPE_TEXT += L_DLL_TEXT;
		if (bIsapi)
			L_APPTYPE_TEXT += L_COMMA_TEXT;
	}
	if (bIsapi)
	{
		L_APPTYPE_TEXT += L_ISAPI_TEXT;
		if (!bCombined)
			L_APPTYPE_TEXT += L_DLL_TEXT;
	}
	if (bCombined)
	{
		L_APPTYPE_TEXT += L_COMBINED_TEXT;
	}

	APPTYPE.innerText = L_APPTYPE_TEXT;
	
	var L_NONATTRIBUTEDAPP_Text = "Non-attributed";
	var L_ATTRIBUTEDAPP_Text = "Attributed";
	if (window.external.FindSymbol("ATTRIBUTED"))
		ATTRIBUTEDAPP.innerText = L_ATTRIBUTEDAPP_Text;
	else
		ATTRIBUTEDAPP.innerText = L_NONATTRIBUTEDAPP_Text;
	
	DEPLOYMENT.parentNode.style.display = 'none';
	if (window.external.FindSymbol("GENERATE_DEPLOYMENT"))
	{
		var L_DEPLOYMENT_Text = "Deployment support";
		DEPLOYMENT.innerText = L_DEPLOYMENT_Text;
		DEPLOYMENT.parentNode.style.display = 'block';
	}

	GENTODO.parentNode.style.display = 'none';
	if (window.external.FindSymbol("TODO"))
	{
		L_TODO_Text = "Generate TODO comments";
		GENTODO.innerText = L_TODO_Text;
		GENTODO.parentNode.style.display = 'block';
	}
	
	WEBDBGOPT.parentNode.style.display = 'none';
	if (window.external.FindSymbol("WEBDBG"))
	{
		L_WEBDBGOPT_Text = "Custom assert and trace handling support";
		WEBDBGOPT.innerText = L_WEBDBGOPT_Text;
		WEBDBGOPT.parentNode.style.display = 'block';
	}

	STENCILSUPPORT.parentNode.style.display = 'none';
	if (bApp && window.external.FindSymbol("STENCIL"))
	{
		L_STENCILSUPPORT_Text = "Stencil support";
		STENCILSUPPORT.innerText = L_STENCILSUPPORT_Text;
		STENCILSUPPORT.parentNode.style.display = 'block';
	}

	VALIDSUPPORT.parentNode.style.display = 'none';
	if (bApp && window.external.FindSymbol("VALIDATION"))
	{
		L_VALIDSUPPORT_Text = "Validation support";
		VALIDSUPPORT.innerText = L_VALIDSUPPORT_Text;
		VALIDSUPPORT.parentNode.style.display = 'block';
	}

	RESERVED1.style.display = 'none';
	RESERVED2.style.display = 'none';
	if (!bIsapi)
	{
		RESERVED1.style.color = 'red';
		RESERVED1.style.fontWeight = "bold";
		RESERVED2.style.color = 'red';
		RESERVED2.style.fontWeight = "bold";
		var L_RESERVED1_TEXT = "WARNING: You need an existing ISAPI DLL";
		var L_RESERVED2_TEXT = " in order for your application DLL to run.";
		RESERVED1.innerText = L_RESERVED1_TEXT;
		RESERVED2.innerText = L_RESERVED2_TEXT;
		RESERVED1.style.display = 'block';
		RESERVED2.style.display = 'block';
	}
}

function Next(document, linkto)
{
	window.external.Next(document, linkto);
}

function OnFinish(document)
{
	OnWizFinish(document);
}

function GetValidUrlString(strValue)
{
	var nLen = strValue.length;
	var strRet = "";
	for (nCntr = 0; nCntr < nLen; nCntr++)
	{
		var cChar = strValue.charAt(nCntr);
		switch(cChar)
		{
			case " ":
			case "~":
			case "&":
			case "'":
			case "#":
			case "!":
			case "@":
			case "$":
			case "%":
			case "^":
			case "(":
			case ")":
			case "-":
			case "+":
			case "=":
			case "{":
			case "}":
			case "[":
			case "]":
			case ";":
			case ",":
			case "`":
			case ".":
			case "*":
			case "\\":
				continue;
			default:
				strRet+= cChar;
		}
	}
	
	return strRet;
}

function getval(obj, strProjName)
{
	var SymbolValue;
	switch(obj.NAME)
	{
		case "SAFE_PROJECT_NAME":
			SymbolValue	= CreateSafeName(strProjName);
			break;
		case  "ISAPI_SERVER":
			SymbolValue = window.external.GetComputerName();
			break;
		case "ISAPI_VROOT":
			{
				if (!window.external.FindSymbol("CLOSE_SOLUTION"))
				{
					var strSolName = "";
					try
					{
						var strFullName = window.external.dte.Solution.FullName;
						var strName = "";
						var nSlash = 0;
						var nDot = 0;
						if (strFullName.length > 0)
						{
							nSlash = strFullName.lastIndexOf("\\");
							if (nSlash == -1)
								nSlash = 0;
							else
								nSlash++;

							nDot = strFullName.lastIndexOf(".");
							if (nDot == -1)
							{
								// no dot in the filename
								strName = strFullName.substr(nSlash);
							}
							else
							{
								if (nDot > nSlash)
									strName = strFullName.substr(nSlash, nDot-nSlash);
							}
						
							if (strName.length > 0)
								SymbolValue = strName;
						
						}
					}
					catch(e)
					{
						SymbolValue = "";				
					}
				}
				
				if (SymbolValue == null || SymbolValue.length <= 0)
				{
					SymbolValue = GetValidUrlString(strProjName);
				}
			}
			break;
		case "SRF_FILE":
			SymbolValue = strProjName+".srf";
			break;
		case  "APP_CLASS":
			{
				var strSafeProjName = CreateSafeName(strProjName);
				SymbolValue = "C" + strSafeProjName + "Handler"; 
			}
			break;
		case  "EXTENSION_CLASS":
           	{
				var strSafeProjName = CreateSafeName(strProjName);
				SymbolValue = "C" + strSafeProjName + "Extension"; 
			}
            break;
		case "EXTENSION_FILE":
			{
				var strSafeProjName = CreateSafeName(strProjName);
				SymbolValue = strSafeProjName+"extension.h";
			}
			break;
		case "APP_FILE":
			{
				SymbolValue = strProjName+".h";
			}
			break;
		case  "SOURCE_FILTER":
			SymbolValue = "cpp;c;cxx;def;odl;idl;hpj;bat;asm"; 
			break;
		case  "INCLUDE_FILTER":
			SymbolValue = "h;hpp;hxx;hm;inl;inc"; 
			break;
		case  "RESOURCE_FILTER":
			SymbolValue = "rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;r"; 
			break;
		case "LANGUAGE":
		case "LANGUAGE_NAME":
			SymbolValue = window.external.GetLangFromLCID(window.external.GetHostLocale());
			break;
		case "LCID":
			SymbolValue = window.external.GetHostLocale().toString();
			break;
		case "HEX_LCID":
			SymbolValue = window.external.GetHostLocale().toString(16);
			break;
		default:
			SymbolValue = "";
			break;
	}
	return (SymbolValue);
}

function onClick(obj)
{
	if (obj.id == "ServerOptions")
	{
		if (window.external.FindSymbol("GENERATE_ISAPI") ||
			window.external.FindSymbol("COMBINE_PROJECTS"))
		{ 
			Next(document, "ServerOptions.htm"); 
		}
	}
	else if (obj.id == "AppOptions")
	{
		if (window.external.FindSymbol("GENERATE_APP") ||
			window.external.FindSymbol("COMBINE_PROJECTS"))
		{
			Next(document, "AppOptions.htm");
		}
	}
}

</SCRIPT>
<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT>
	var strPath = "../../../";
	strPath += window.external.GetHostLocale();
	var strScriptPath = strPath + "/Script.js";
	var strCommonPath = strPath + "/Common.js";
	document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
	document.scripts("INCLUDE_COMMON").src = strCommonPath;
</SCRIPT>
