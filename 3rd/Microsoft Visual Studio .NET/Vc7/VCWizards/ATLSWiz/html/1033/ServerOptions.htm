<!- (c) 2001 Microsoft Corporation -->
<HTML DIR="LTR">

<HEAD>
	<TITLE>ATL Server Project Wizard</TITLE>
	<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
	<STYLE TYPE="text/css">@import url();</STYLE>
	<SCRIPT>
		var strURL = "../../../";
		strURL += window.external.GetHostLocale();
		strURL += "/NewStyles.css";
		document.styleSheets(0).imports(0).href = strURL;
	</SCRIPT>
</HEAD>

<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="if (!bValidating) OnKey();" ONKEYPRESS="if (!bValidating) OnPress();">

<TABLE CLASS="ONE" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<COL WIDTH="178"><COL>

  <!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
  <TR VALIGN="TOP">
	<TD HEIGHT="79" WIDTH="100%" COLSPAN="2">
	 <TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
	 <COL WIDTH="12"><COL><COL WIDTH="12">
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
		<DIV CLASS="SMALLA" ID="Layer1">
		 <IMG CLASS="SMALL" SRC="../../Images/ATLSWiz1.gif" WIDTH="98" HEIGHT="70" ALT="" BORDER="0">
		</DIV>
	   </TD>

	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65">
		<H4 CLASS="HEAD" ID="HEAD">Server Options</H4>
		<P CLASS="SUBHEAD" ID="SUBHEAD">Choose the options to be supported by the ISAPI extension DLL.</P>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
		<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
	  	 <TR VALIGN="TOP">
	  	  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
	  	  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
	  	 </TR>
		</TABLE>
	   </TD>
	  </TR>
	 </TABLE>
	</TD>
  </TR>
  <!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->

  <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
  <TR VALIGN="TOP">
	<TD CLASS="Three" VALIGN="TOP" HEIGHT="100%" WIDTH="178">
	 <TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="178" BORDER="0" CELLPADDING="0" CELLSPACING="0">
  	  <TR VALIGN="TOP">
	   <TD CLASS="threeCustom" VALIGN="TOP" STYLE="BACKGROUND-IMAGE: URL(../../Images/ATL_Server_Background.gif);">
	   	<!--OPEN OF NAVIGATION TABLE//-->

	    <TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="12"><COL WIDTH="166"><COL WIDTH="1">
		 <TR>
	   	  <TD VALIGN="TOP" COLSPAN="3" HEIGHT="12">
	  		&nbsp;
		  </TD>
		 </TR>
		 <TR>
	   	  <TD VALIGN="TOP" HEIGHT="100%" WIDTH="12">
	  		&nbsp;
		  </TD>
	   	  <TD VALIGN="TOP" HEIGHT="100%" WIDTH="165">
	   	  <!--OPEN OF NAVIGATIONAL LINKS//-->
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="Default" TITLE="Examine an overview of selections" onClick="Next(document, 'Default.htm');" TABINDEX="1">Overview</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="AppSettings" TITLE="Choose the project types to be generated along with their names and locations" onClick="Next(document, 'AppSettings.htm');" TABINDEX="2">Project Settings</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>

		  	<DIV CLASS="LINKSELECTED">
	 	   	 <SPAN CLASS="VERTLINE1">
			  <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
			 </SPAN>
			 <SPAN CLASS="HORILINE1">
			  <TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
				</TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD HEIGHT="100%">
				 <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="28" ALT="" BORDER="0">
			    </TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
			    </TD>
			   </TR>
			  </TABLE>
			 </SPAN>
			 <TABLE WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTSELECTEDINDENT">
			  <TR VALIGN="MIDDLE">
			   <TD WIDTH="156">
				<SPAN ID="ServerOptions" TITLE="Choose the options to be supported by the ISAPI extension DLL">Server Options</SPAN>
			   </TD>
			   <TD WIDTH="4">
				<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTINDENT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="AppOptions" TITLE="Choose the options to be supported by the Web application DLL" onClick="onClick(this);" TABINDEX="3">Application Options</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="DevOptions" TITLE="Choose the options that configure the generated projects to the way that you work best" onClick="Next(document, 'DevOptions.htm');" TABINDEX="4">Developer Support Options</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
			
	   	  <!--CLOSE OF NAVIGATIONAL LINKS//-->
		  </TD>
		  <TD WIDTH="1">
		   <DIV CLASS="VERTLINE">
			 <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
		   </DIV>
		  </TD>
		 </TR>
		 </TABLE>
		</TD>
	   </TR>
	   </TABLE>
			
	   <!--CLOSE OF NAVIGATION TABLE//-->
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="100%">
	   <!--OPEN OF CONTENT AND BUTTON TABLE//-->
	   
	   	<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="100%">
		 <TR VALIGN="TOP">
		  <TD HEIGHT="100%">
	   	  <!--OPEN OF CONTENT//-->
		  
		  	<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL WIDTH="193"><COL WIDTH="12"><COL WIDTH="193"><COL WIDTH="12">
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="3">
  				&nbsp;
  			  </TD>
 			 </TR>
 			 <TR>
 			 <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
 				<SPAN CLASS="itemTextTop" TITLE="Specifies whether the ISAPI extension DLL supports additional services." ID="options_title">Additional support options:
	  				 <P CLASS="Spacer">&nbsp;</P>
	  
	  				 <INPUT TYPE="checkbox" CLASS="CheckBoxA" ID="BLOB_CACHE" ACCESSKEY="b" TITLE="Specifies whether to add code that allows the efficient storage and retrieval of arbitrary data." onPropertychange="OnBlobCache();">
	  	 			 <DIV CLASS="itemTextCheckboxB" ID="ITEMCHECKBOX1_DIV" TITLE="Specifies whether to add code that allows the efficient storage and retrieval of arbitrary data.">
		  			  <LABEL FOR="BLOB_CACHE" ID="BLOB_CACHE_LABEL"><U>B</U>lob cache</LABEL>
	  	 			 </DIV>
	  
	  				 <BR>
	  
	  				 <INPUT TYPE="checkbox" CLASS="CheckBoxA" ID="FILE_CACHE" ACCESSKEY="i" TITLE="Specifies whether to add code that allows the efficient storage and retrieval of files and file data." onPropertychange="OnFileCache();">
	  	 			 <DIV CLASS="itemTextCheckboxB" ID="ITEMCHECKBOX2_DIV" TITLE="Specifies whether to add code that allows the efficient storage and retrieval of files and file data.">
		  			  <LABEL FOR="FILE_CACHE" ID="FILE_CACHE_LABEL">F<U>i</U>le cache</LABEL>
	  	 			 </DIV>
	  
	  				 <BR>
	  
	  				 <INPUT TYPE="checkbox" CLASS="CheckBoxA" ID="DATASOURCE_CACHE" ACCESSKEY="a" TITLE="Specifies whether to add code that allows the per-thread caching of OLE DB data source connections." onPropertychange="OnDatasourceCache();">
	  	 			 <DIV CLASS="itemTextCheckboxB" ID="ITEMCHECKBOX3_DIV" TITLE="Specifies whether to add code that allows the per-thread caching of OLE DB data source connections.">
		  			  <LABEL FOR="DATASOURCE_CACHE" ID="DATASOURCE_CACHE_LABEL">D<U>a</U>ta source cache</LABEL>
	  	 			 </DIV>
	  
	  				 <BR>
	  
	  				 <INPUT TYPE="checkbox" CLASS="CheckBoxA" ID="PERFMON" ACCESSKEY="p" TITLE="Specifies whether to add performance monitoring support to the ISAPI extension. The extension DLL must be registered if this option is selected." onPropertychange="OnPerfMon();">
	  	 			 <DIV CLASS="itemTextCheckboxB" ID="ITEMCHECKBOX4_DIV" TITLE="Specifies whether to add performance monitoring support to the ISAPI extension. The extension DLL must be registered if this option is selected.">
		  			  <LABEL FOR="PERFMON" ID="PERFMON_LABEL">Predefined <U>p</U>erformance counters</LABEL>
	  	 			 </DIV>
	
	  				 <BR>	
	
	  				 <INPUT TYPE="checkbox" CLASS="CheckBoxA" ID="BROWSCAPS" ACCESSKEY="w" TITLE="Specifies whether to expose the browser capabilities service from the ISAPI extension." onPropertychange="OnBrowsCaps();">
	  	 			 <DIV CLASS="itemTextCheckboxB" ID="ITEMCHECKBOX5_DIV" TITLE="Specifies whether to expose the browser capabilities service from the ISAPI extension.">
		  			  <LABEL FOR="BROWSCAPS" ID="BROWSCAPS_LABEL">Bro<U>w</U>ser capabilities support</LABEL>
	  	 			 </DIV>	
				</SPAN>
	
				<P CLASS="ElementSpacer7">&nbsp;</P>
				
     			<SPAN CLASS="itemText" ID="SPEC_LANGUAGE_TEXT" TITLE="Specifies the language for resources generated by the wizard.">
	  	 			 <LABEL ID="LANGUAGE_TEXT" FOR="LANGUAGE">Resource <U>l</U>anguage:</LABEL>
	  	 			 <BR>
	  	 			 <SELECT CLASS="sideBtn" SIZE="1" ID="LANGUAGE" ACCESSKEY="l" onChange="OnLang();" TITLE="Specifies the language for resources generated by the wizard.">
	  	 			 </SELECT>
	 			</SPAN>
  		  	  </TD>
  
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>

			  <TD VALIGN="TOP">
				<SPAN CLASS="itemTextTop">
	  				 <INPUT CLASS="CheckBox" TYPE="checkbox" ID="SOME_SESSION" ACCESSKEY="e" TITLE="Specifies whether to add support for session state services to the ISAPI extension, allowing the creation, storage, and retrieval of data across requests." onPropertychange="OnSession();">
	  	 			 <DIV CLASS="itemTextCheckboxA" ID="ITEMCHECKBOX5_DIV" TITLE="Specifies whether to add support for session state services to the ISAPI extension, allowing the creation, storage, and retrieval of data across requests.">
		  			  <LABEL FOR="SOME_SESSION" ID="SOME_SESSION_LABEL">S<U>e</U>ssion services</LABEL>
	  	 			 </DIV>
	  
	  				 <BR>
	  
	  			 	 <INPUT CLASS="RadioIndenta" TYPE="radio" ACCESSKEY="d" NAME="sessiontype" ID="SESSION_DB" TITLE="Persists session data to an OLE DB data source. Suitable for Web farms." onClick="OnDBSession();">
	  			 	 <DIV CLASS="itemTextRadioIndentA" ID="session_db_title" TITLE="Persists session data to an OLE DB data source. Suitable for Web farms.">
	  				  <LABEL FOR="SESSION_DB" ID="SESSION_DB_LABEL">OLE <U>D</U>B-backed session-state services</LABEL>
	  			 	 </DIV>
	  
	  				 <BR>
	  
	  			 	 <INPUT CLASS="RadioIndenta" TYPE="radio" NAME="sessiontype" ID="SESSION_MEM" ACCESSKEY="m" TITLE="Persists session data to memory. Not usually suitable for Web farms without server affinity." onClick="OnMemSession();">
	  			 	 <DIV CLASS="itemTextRadioIndentA" ID="session_mem_title" TITLE="Persists session data to memory. Not usually suitable for Web farms without server affinity.">
	  				  <LABEL FOR="SESSION_MEM" ID="SESSION_MEM_LABEL"><U>M</U>emory-backed session-state services</LABEL>
	  			 	 </DIV>
				 </SPAN>

				<P CLASS="ElementSpacer">&nbsp;</P>
  
   				<SPAN CLASS="itemTextIndent" ID="sdstitle">Data source:
	  				 <P CLASS="Spacer">&nbsp;</P>
	  
	  				 <BUTTON CLASS="buttonClass" ID="DatSupBtn" DISABLED ACCESSKEY="s" TYPE="BUTTON" VALUE="Data Source" TITLE="Specifies an existing database as the store for the session data." onClick="SelectDataSource();">Data <U>S</U>ource...</BUTTON>
				</SPAN>
  		  	  </TD>
  
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
		 	</TABLE>
			
	   	  <!--CLOSE OF CONTENT//-->
		  </TD>
		 </TR>
		 <TR VALIGN="BOTTOM">
		  <TD HEIGHT="48">
	   	  <!--OPEN OF BUTTON HTML//-->
		  
		  	<TABLE HEIGHT="48" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="12">
			 <TR>
  			  <TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
				<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
  	 			 <TR VALIGN="TOP">
  	  			  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
  	  			  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
  	 			 </TR>
				</TABLE>
  			  </TD>
 			  </TR>
 
 			  <TR>
  			  <TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			<TR>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" HEIGHT="23">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">Finish</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">Cancel</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="window.external.OnHelp('vc.appwiz.atl.server.servopt');">Help</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
			</TABLE>
			
	   	  <!--CLOSE OF BUTTON HTML//-->
		  </TD>
		 </TR>
		</TABLE>
	
  	<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
 	</TD>
  </TR>
</TABLE>

</BODY>
</HTML>

<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Default;
tab_array[1] = AppSettings;
tab_array[2] = ServerOptions;
tab_array[3] = AppOptions;
tab_array[4] = DevOptions;

var bDataSourceDlg = false;

function InitDocument(document)
{
	setDirection();
	InitTabs();
	window.external.Load(document);
	PopulateLanguages();	
	//InitControls();
	if (window.external.FindSymbol("SOME_SESSION") == true)
	{
		if (window.external.FindSymbol("SESSION_DB") == true)
		{
			DATASOURCE_CACHE.disabled = true;
			DATASOURCE_CACHE_LABEL.disabled = true;
			ITEMCHECKBOX3_DIV.disabled = true;
		}
	}
	OnSession();
	BLOB_CACHE.focus();
}

function PopulateLanguages()
{
	var oLangList = document.all.tags("SELECT").item("LANGUAGE");

	// Scan the templates directory for the available languages
	//
	var strInstalledLangs = window.external.GetInstalledLangs();
	var len = strInstalledLangs.length;
	var strLangId = "";

	
	// Populate the list
	//
	for (i = 0; i < len; i++)
	{
		var strNext = strInstalledLangs.substr(i,1);
		if (strNext == ",")
		{
			var oOption = document.createElement("OPTION");
			oOption.value = strLangId;
			oOption.text = window.external.GetLangFromLCID(strLangId);
			oLangList.add(oOption);
			strLangId = "";
			continue;
		}
		strLangId += strNext;
	}
	var oOption = document.createElement("OPTION");
	oOption.value = strLangId;
	oOption.text = window.external.GetLangFromLCID(strLangId);
	oLangList.add(oOption);


	var strHostLocale = window.external.GetHostLocale();
	var strSystemLocale = window.external.GetSystemLCID();

	var nEnglishIndex = 0;

	for (i = 0; i < len; i++)
	{
		var val = oLangList.options[i].value;

		// If the language of the VS Environment is running in 
		// is available it should default to that language.
		//
		// If the language that the system is running in 
		// (system default locale) is available it should 
		// default to that resource language.
		//
		if (val == strHostLocale || val == strSystemLocale)
		{
			oLangList.selectedIndex = i;
			return;
		}
		if (val == "1033")
			nEnglishIndex = i;
	}

	// If the language that the system is running in 
	// (system default locale) is *not* available it 
	// should default to English (available on all installs)
	//
	oLangList.selectedIndex = nEnglishIndex;
}

function InitControls()
{
	BLOB_CACHE.checked = window.external.FindSymbol("BLOB_CACHE");
	FILE_CACHE.checked = window.external.FindSymbol("FILE_CACHE");
	SOME_SESSION.checked = window.external.FindSymbol("SOME_SESSION");
	SESSION_DB.checked = window.external.FindSymbol("SESSION_DB");
	SESSION_MEM.checked = window.external.FindSymbol("SESSION_MEM");
	DATASOURCE_CACHE.checked = window.external.FindSymbol("DATASOURCE_CACHE");
}

function InitTabs()
{
	MouseOut(ServerOptions);
	MouseOut(AppOptions);
}

function CheckDataSource()
{
	if (SOME_SESSION.checked == true && SESSION_DB.checked == true)
	{
		if (window.external.FindSymbol("DB_CONNECTION_STRING") == "")
		{
			L_Err1_Text = "You must specify a data source when the OLE DB backed Session State Option is checked";
			window.external.ReportError(L_Err1_Text);
			return false;
		}
	}
	
	return true;
}

function Next(document, linkto)
{
	if (!CheckDataSource())
		return;
		
	window.external.Next(document, linkto);
}

function OnFinish(document)
{
	if (!CheckDataSource())
		return;
		
	OnWizFinish(document);
}

function SelectDataSource()
{
	if (SOME_SESSION.checked == true && SESSION_DB.checked == true)
	{
		bDataSourceDlg = true;
		try
		{
			var strConnectString = "";
			strConnectString = window.external.GetConnectionString(true);
			if (strConnectString != "")
			{
				window.external.AddSymbol("DB_CONNECTION_STRING", strConnectString);
				L_SecWarning1_Text = "The connection string in the generated code may contain\r\n";
				L_SecWarning2_Text = "plain text passwords and/or other sensitive information.\r\n";
				L_SecWarning3_Text = "Please review the wizard generated code for details.";
				window.external.ReportError(L_SecWarning1_Text + L_SecWarning2_Text + L_SecWarning3_Text);
			}
		}
		catch(e)
		{
//			L_Err2_Text = "ERROR: ";
//			window.external.ReportError(L_Err2_Text + e.description);
		}
		bDataSourceDlg = false;
	}
}

function onClick(obj)
{
	if (obj.id == "ServerOptions")
	{
		if (window.external.FindSymbol("GENERATE_ISAPI") || 
			window.external.FindSymbol("COMBINE_PROJECTS")) 
		{ 
			Next(document, "ServerOptions.htm"); 
		}
	}
	else if (obj.id == "AppOptions")
	{
		if (window.external.FindSymbol("GENERATE_APP") ||
			window.external.FindSymbol("COMBINE_PROJECTS")) 
		{
			Next(document, "AppOptions.htm");
		}
	}
}

function OnServiceNone()
{
	window.external.AddSymbol("SERVICE_NONE", SERVICE_NONE.checked);
}

function OnBlobCache()
{
	window.external.AddSymbol("BLOB_CACHE", BLOB_CACHE.checked);
}

function OnFileCache()
{
	window.external.AddSymbol("FILE_CACHE", FILE_CACHE.checked);
}

function OnSession()
{
	if (SOME_SESSION.checked == true)
	{
		SESSION_MEM.disabled = false;
		SESSION_DB.disabled = false;
		session_mem_title.disabled = false;
		session_db_title.disabled = false;
		if ( window.external.FindSymbol("SESSION_DB") == false && window.external.FindSymbol("SESSION_MEM") == false)
		{
			SESSION_DB.checked = true;
			OnDBSession();
		}
		else
		{
			if (window.external.FindSymbol("SESSION_DB") == true)
				OnDBSession();
			else
				OnMemSession();
		}
	}
	else
	{
		window.external.AddSymbol("SESSION_MEM", false);
		window.external.AddSymbol("SESSION_DB", false);
		SESSION_MEM.disabled = true;
		SESSION_DB.disabled = true;
		session_mem_title.disabled = true;
		session_db_title.disabled = true;
		DATASOURCE_CACHE.disabled = false;
		DATASOURCE_CACHE_LABEL.disabled = false;
		ITEMCHECKBOX3_DIV.disabled = false;
	}

	ToggleDatSupBtn();
}
	
function ToggleDatSupBtn()
{
	DatSupBtn.disabled = true;
	sdstitle.disabled = true;
	if (SOME_SESSION.checked == true && SESSION_DB.checked == true)
	{
		DatSupBtn.disabled = false;
		sdstitle.disabled = false;
	}
}

function OnMemSession()
{
	if (SESSION_MEM.checked == true)
	{
		SESSION_DB.checked = false;
		window.external.AddSymbol("SESSION_DB", false);
		window.external.AddSymbol("SESSION_MEM", true);
		DATASOURCE_CACHE.checked = window.external.FindSymbol("_DS_CHECKED");
		DATASOURCE_CACHE.disabled = false;
		DATASOURCE_CACHE_LABEL.disabled = false;
		ITEMCHECKBOX3_DIV.disabled = false;
	}

	ToggleDatSupBtn();
}

function OnDBSession()
{
	if (SESSION_DB.checked == true)
	{
		SESSION_MEM.checked = false;
		window.external.AddSymbol("SESSION_MEM", false);
		window.external.AddSymbol("SESSION_DB", true);
		window.external.AddSymbol("_DS_CHECKED", DATASOURCE_CACHE.checked);
		DATASOURCE_CACHE.checked = true;
		DATASOURCE_CACHE.disabled = true;
		DATASOURCE_CACHE_LABEL.disabled = true;
		ITEMCHECKBOX3_DIV.disabled = true;
	}
	else
	{
		DATASOURCE_CACHE.checked = window.external.FindSymbol("_DS_CHECKED");
	}

	ToggleDatSupBtn();
}

function OnPerfMon()
{
	window.external.AddSymbol("PERFMON", PERFMON.checked);
}

function OnDatasourceCache()
{
	window.external.AddSymbol("DATASOURCE_CACHE", DATASOURCE_CACHE.checked);
}

function OnBrowsCaps()
{
	window.external.AddSymbol("BROWSCAPS", BROWSCAPS.checked);
}

function OnLang()
{
	var oLangs = document.all.tags("SELECT").item("LANGUAGE");
	if (oLangs != null)
	{
		oLang = oLangs.options[oLangs.selectedIndex];
		var strLCID = oLang.value;

		// fix up the templates path for the locale
		var strCurrentTemplatesPath = window.external.FindSymbol("TEMPLATES_PATH");
		var nIndex = strCurrentTemplatesPath.lastIndexOf("\\");
		var strSubstr = strCurrentTemplatesPath.substr(0, nIndex);
		var strNewTemplatesPath = strSubstr + "\\" + strLCID;
		window.external.AddSymbol("TEMPLATES_PATH", strNewTemplatesPath);

		var strLang = window.external.GetLangFromLCID(strLCID);
		window.external.AddSymbol("LANGUAGE", strLang);
		window.external.AddSymbol("LANGUAGE_NAME", strLang);

		window.external.AddSymbol("LCID", strLCID);
		var nlc = new Number(strLCID);
		window.external.AddSymbol("HEX_LCID", nlc.toString(16));

		var strSysLcid = window.external.GetSystemLCID();
		var strCodePage = window.external.GetCodePageFromLCID(strSysLcid);
		window.external.AddSymbol("CODE_PAGE", strCodePage);
		var ncp = new Number(strCodePage);
		window.external.AddSymbol("HEX_CODE_PAGE", ncp.toString(16));

		window.external.AddSymbol("PRIMARY_LANG_ID", window.external.GetPrimaryLangIdFromLCID(strSysLcid));
		window.external.AddSymbol("SUB_LANG_ID", window.external.GetSubLangIdFromLCID(strSysLcid));
		window.external.AddSymbol("LANG_SUFFIX", window.external.GetLangAbbrevFromLCID(strLCID));
		window.external.AddSymbol("IS_ENGLISH", (strLCID == "1033"));
	}
}

</SCRIPT>
<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT>
	var strPath = "../../../";
	strPath += window.external.GetHostLocale();
	var strScriptPath = strPath + "/Script.js";
	var strCommonPath = strPath + "/Common.js";
	document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
	document.scripts("INCLUDE_COMMON").src = strCommonPath;
</SCRIPT>