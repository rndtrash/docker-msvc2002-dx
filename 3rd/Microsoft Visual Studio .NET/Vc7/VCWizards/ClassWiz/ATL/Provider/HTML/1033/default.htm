<!- (c) 2001 Microsoft Corporation -->
<HTML DIR="LTR">

<HEAD>
	<TITLE>ATL OLE DB Provider Wizard</TITLE>
	<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
	<STYLE TYPE="text/css">@import url();</STYLE>
	<SCRIPT>
		var strURL = "../../../../../";
		strURL += window.external.GetHostLocale();
		strURL += "/NewStyles.css";
		document.styleSheets(0).imports(0).href = strURL;
	</SCRIPT>

	<SYMBOL NAME="SHORT_NAME" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="COCLASS" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="PROGID" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="VERSION" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="TYPE_NAME" TYPE=text VALUE=""></SYMBOL>

	<SYMBOL NAME="DATASOURCE_CLASS" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="SESSION_CLASS" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="COMMAND_CLASS" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="ROWSET_CLASS" TYPE=text VALUE=""></SYMBOL>

	<SYMBOL NAME="DATASOURCE_HEADER" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="SESSION_HEADER" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="ROWSET_HEADER" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="ROWSET_IMPL" TYPE=text VALUE=""></SYMBOL>

	<SYMBOL NAME="DATASOURCE_HEADER_VALID" TYPE=bool VALUE=false></SYMBOL>
	<SYMBOL NAME="SESSION_HEADER_VALID" TYPE=bool VALUE=false></SYMBOL>
	<SYMBOL NAME="ROWSET_HEADER_VALID" TYPE=bool VALUE=false></SYMBOL>
	<SYMBOL NAME="ROWSET_IMPL_VALID" TYPE=bool VALUE=false></SYMBOL>

	<SYMBOL NAME="MERGE_FILE" TYPE="bool" VALUE="false"></SYMBOL>

	<SYMBOL NAME="SAFE_PROJECT_NAME" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="ATTRIBUTED" TYPE=checkbox VALUE=false></SYMBOL>

	<SYMBOL NAME="CLSID_REGISTRY_FORMAT" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="APPID_REGISTRY_FORMAT" TYPE=text VALUE=""></SYMBOL>
	<SYMBOL NAME="APPID_EXIST" TYPE=bool VALUE=false></SYMBOL>
</HEAD>

<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="OnKey();" ONKEYPRESS="OnPress();">

<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<COL WIDTH="100%">
  <TR VALIGN="TOP">
	<TD HEIGHT="79">
	<!--OPEN OF ALL ENCOMPASSING TABLE ROW ONE//-->
	 <TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
	 <COL WIDTH="12"><COL><COL WIDTH="12">
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
		<DIV CLASS="SMALLA" ID="Layer0">
		 <IMG CLASS="SMALLEST" SRC="..\..\Images\ATL_Provider.gif" WIDTH="63" HEIGHT="63" ALT="" BORDER="0">
		</DIV>
	   </TD>

	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65">
		<H4 CLASS="HEAD" ID="HEAD">Welcome to the ATL OLE DB Provider Wizard</H4>
		<P CLASS="SUBHEAD" ID="SUBHEAD">This wizard adds code to support OLE DB provider templates.</P>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
		<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
	  	 <TR VALIGN="TOP">
	  	  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
	  	  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
	  	 </TR>
		</TABLE>
	   </TD>
	  </TR>
	 </TABLE>
	 
	<!--CLOSE OF ALL ENCOMPASSING TABLE ROW ONE//-->
	</TD>
	</TR>
	<TR VALIGN="TOP">
	<TD HEIGHT="100%">
	<!--OPEN OF ALL ENCOMPASSING TABLE ROW TWO//-->
	
	 <TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
	 <COL>
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="100%">
	   <!--OPEN OF CONTENT AND BUTTON TABLE//-->
	   
	   	<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="100%">
		 <TR VALIGN="TOP">
		  <TD HEIGHT="100%">
	   	  <!--OPEN OF CONTENT//-->
		  
		  	<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL WIDTH="185"><COL WIDTH="12"><COL WIDTH="185"><COL WIDTH="12"><COL WIDTH="185"><COL WIDTH="12">
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="5">
  				&nbsp;
  			  </TD>
 			 </TR>
			 
 			 <TR VALIGN="TOP">
 			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
  				<SPAN CLASS="itemTextTop" ID="SHORT_NAME_SPAN" TITLE="Type the short name of the provider to be created here. The other edit boxes in the wizard will automatically populate based on what you type here. Edit the other name boxes, if desired.">
	  	 			 <LABEL FOR="SHORT_NAME" ID="SHORT_NAME_LABEL" TITLE="Type the short name of the provider to be created here. The other edit boxes in the wizard will automatically populate based on what you type here. Edit the other name boxes, if desired."><U>S</U>hort name:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnThreeColumn" ID="SHORT_NAME" ACCESSKEY="S" TYPE="text" TITLE="Type the short name of the provider to be created here. The other edit boxes in the wizard will automatically populate based on what you type here. Edit the other name boxes, if desired." onPropertyChange="OnShortName();">
				</SPAN>
  		  	  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
  				<SPAN CLASS="itemTextTop" ID="COCLASS_SPAN" TITLE="The name of the CoClass. The ProgID name will change to match this name.">
	  	 			 <LABEL FOR="COCLASS" ID="COCLASS_LABEL" TITLE="The name of the CoClass. The ProgID name will change to match this name.">C<u>o</u>class:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnThreeColumn" ID="COCLASS" ACCESSKEY="O" TYPE="text" TITLE="The name of the CoClass. The ProgID name will change to match this name." onPropertyChange="OnCoclass();">
				</SPAN>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="MIDDLE">
			  	<SPAN CLASS="itemText" ID="ATTRIBUTED_SPAN" TITLE="This option is selected by default to create an ATL project that uses attributes. When you select this option, the wizard uses attributes instead of template declarations. When you deselect this option, the wizard uses template declarations instead of attributes." STYLE="POSITION:RELATIVE; TOP:.2EM;">
	  				 <INPUT CLASS="CheckBox" TYPE="checkbox" ID="ATTRIBUTED" ACCESSKEY="A" TITLE="This option is selected by default to create an ATL project that uses attributes. When you select this option, the wizard uses attributes instead of template declarations. When you deselect this option, the wizard uses template declarations instead of attributes." onPropertychange="OnAttributed();">
	  	 			 <DIV CLASS="itemTextCheckboxA" ID="ATTRIBUTED_DIV">
		  			  <LABEL FOR="ATTRIBUTED" TITLE="This option is selected by default to create an ATL project that uses attributes. When you select this option, the wizard uses attributes instead of template declarations. When you deselect this option, the wizard uses template declarations instead of attributes." ID="ATTRIBUTED_LABEL"><U>A</U>ttributed</LABEL>
	  	 			 </DIV>
				</SPAN>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
			 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="8" COLSPAN="5">
  				&nbsp;
  			  </TD>
 			 </TR>
			 
 			 <TR VALIGN="TOP">
 			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
  				<SPAN CLASS="itemText" ID="VERSION_INDEPENDENT_PROGID_SPAN" TITLE="The Prog ID, or programmatic identifier, is a text string that your application can use instead of a GUID. The ProgID name has the form Projectname.CoClassname.">
	  	 			 <LABEL FOR="VERSION_INDEPENDENT_PROGID" ID="VERSION_INDEPENDENT_PROGID_LABEL" TITLE="The Prog ID, or programmatic identifier, is a text string that your application can use instead of a GUID. The ProgID name has the form Projectname.CoClassname.">Pro<U>g</U>ID:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnThreeColumn" maxlength="39" ID="VERSION_INDEPENDENT_PROGID" ACCESSKEY="G" TITLE="The Prog ID, or programmatic identifier, is a text string that your application can use instead of a GUID. The ProgID name has the form Projectname.CoClassname." TYPE="text">
				</SPAN>
  		  	  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
  				<SPAN CLASS="itemText" ID="VERSION_SPAN" TITLE="The version number of your provider. The default is 1.">
	  	 			 <LABEL FOR="VERSION" ID="VERSION_LABEL" TITLE="The version number of your provider. The default is 1."><U>V</U>ersion:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnThreeColumn" ID="VERSION" ACCESSKEY="V" TITLE="The version number of your provider. The default is 1." TYPE="text">
				</SPAN>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
			  	&nbsp;
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
			 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="8" COLSPAN="5">
  				&nbsp;
  			  </TD>
 			 </TR>
			 
 			 <TR VALIGN="TOP">
 			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
  				<SPAN CLASS="itemText" ID="DATASOURCE_CLASS_SPAN" TITLE="The name of the data source class, of the form CShortnameSource.">
	  	 			 <LABEL FOR="DATASOURCE_CLASS" ID="DATASOURCE_CLASS_LABEL" TITLE="The name of the data source class, of the form CShortnameSource."><U>D</U>ataSource class:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnThreeColumn" ID="DATASOURCE_CLASS" ACCESSKEY="D" TITLE="The name of the data source class, of the form CShortnameSource." TYPE="text">
				</SPAN>
  		  	  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
			  	<NOBR>
  				  <SPAN CLASS="itemText" ID="DATASOURCE_HEADER_SPAN" TITLE="The header file for the data source class. You can edit this file's name or select an existing header file.">
	  	 			<LABEL FOR="DATASOURCE_HEADER" ID="DATASOURCE_HEADER_LABEL" TITLE="The header file for the data source class. You can edit this file's name or select an existing header file.">Da<U>t</U>aSource .h file:</LABEL>
	  	 			<BR>
	  	 			<INPUT CLASS="sideBtn21" ID="DATASOURCE_HEADER" ACCESSKEY="." TITLE="The header file for the data source class. You can edit this file's name or select an existing header file." TYPE="text" onPropertyChange="window.external.AddSymbol('DATASOURCE_HEADER_VALID', false);">
				 	<BUTTON CLASS="buttonClass3Custom" ID="BROWSE_DATASOURCE_HEADER" TYPE="BUTTON" TITLE="Browse for header file." onClick="OnBrowseHeaderFile(this);">...</BUTTON>
				 </SPAN>
				</NOBR>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
			  	&nbsp;
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
			 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="8" COLSPAN="5">
  				&nbsp;
  			  </TD>
 			 </TR>
			 
 			 <TR VALIGN="TOP">
 			 <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
  				<SPAN CLASS="itemText" ID="SESSION_CLASS_SPAN" TITLE="The name of the session class, of the form CShortnameSession.">
	  	 			 <LABEL FOR="SESSION_CLASS" ID="SESSION_CLASS_LABEL" TITLE="The name of the session class, of the form CShortnameSession.">Sessio<U>n</U> class:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnThreeColumn" ID="SESSION_CLASS" ACCESSKEY="N" TYPE="text" TITLE="The name of the session class, of the form CShortnameSession.">
				</SPAN>
  		  	  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
			  	<NOBR>
				  <SPAN CLASS="itemText" ID="SESSION_HEADER_SPAN" TITLE="The header file for the session class. You can edit this file's name or select an existing header file.">
	  	 			<LABEL FOR="SESSION_HEADER" ID="SESSION_HEADER_LABEL" TITLE="The header file for the session class. You can edit this file's name or select an existing header file.">S<U>e</U>ssion .h file:</LABEL>
	  	 			<BR>
	  	 			<INPUT CLASS="sideBtn21" ID="SESSION_HEADER" ACCESSKEY="I" TYPE="text" TITLE="The header file for the session class. You can edit this file's name or select an existing header file." onPropertyChange="window.external.AddSymbol('SESSION_HEADER_VALID', false);">
				 	<BUTTON CLASS="buttonClass3Custom" ID="BROWSE_SESSION_HEADER" TYPE="BUTTON" TITLE="Browse for header file." onClick="OnBrowseHeaderFile(this);">...</BUTTON>
				  </SPAN>
				</NOBR>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
			  	&nbsp;
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
			 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="8" COLSPAN="5">
  				&nbsp;
  			  </TD>
 			 </TR>
			 
 			 <TR VALIGN="TOP">
 			 <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
  				<SPAN CLASS="itemText" ID="COMMAND_CLASS_SPAN" TITLE="The name of the command class, of the form CShortnameCommand.">
	  	 			 <LABEL FOR="COMMAND_CLASS" ID="COMMAND_CLASS_LABEL" TITLE="The name of the command class, of the form CShortnameCommand.">Co<U>m</U>mand class:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnThreeColumn" ID="COMMAND_CLASS" ACCESSKEY="M" TYPE="text" TITLE="The name of the command class, of the form CShortnameCommand.">
				</SPAN>
  		  	  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
  				<NOBR>
  				  <SPAN ID="COMMAND_HEADER_SECTION">
  				  <SPAN CLASS="itemText" ID="COMMAND_HEADER_SPAN" TITLE="The header file for the command class. This name cannot be edited and depends on the name of the rowset header file.">
	  	 			<LABEL FOR="COMMAND_HEADER" ID="COMMAND_HEADER_LABEL" TITLE="The header file for the command class. This name cannot be edited and depends on the name of the rowset header file.">Command .h f<U>i</U>le:</LABEL>
	  	 			<BR>
	  	 			<INPUT CLASS="sideBtn21" ID="COMMAND_HEADER" ACCESSKEY="L" TYPE="text" TITLE="The header file for the command class. This name cannot be edited and depends on the name of the rowset header file.">
				 	<BUTTON CLASS="buttonClass3Custom" ID="BROWSE_COMMAND_HEADER" TYPE="BUTTON" TITLE="Browse for header file." onClick="OnBrowseHeaderFile(this);">...</BUTTON>
				  </SPAN>
				  </SPAN>
				</NOBR>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
				&nbsp;
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
			 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="8" COLSPAN="5">
  				&nbsp;
  			  </TD>
 			 </TR>
			 
 			 <TR VALIGN="TOP">
 			 <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
  				<SPAN CLASS="itemText" ID="ROWSET_CLASS_SPAN" TITLE="The name of the rowset class, of the form CShortnameRowset.">
	  	 			 <LABEL FOR="ROWSET_CLASS" ID="ROWSET_CLASS_LABEL" TITLE="The name of the rowset class, of the form CShortnameRowset."><U>R</U>owset class:</LABEL>
	  	 			 <BR>
	  	 			 <INPUT CLASS="sideBtnThreeColumn" ID="ROWSET_CLASS" ACCESSKEY="R" TYPE="text" TITLE="The name of the rowset class, of the form CShortnameRowset.">
				</SPAN>
  		  	  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
			  	<NOBR>
				  <SPAN CLASS="itemText" ID="ROWSET_HEADER_SPAN" TITLE="The header file for the rowset class. You can edit this file's name or select an existing header file.">
	  	 			<LABEL FOR="ROWSET_HEADER" ID="ROWSET_HEADER_LABEL" TITLE="The header file for the rowset class. You can edit this file's name or select an existing header file.">Ro<U>w</U>set .h file:</LABEL>
	  	 			<BR>
	  	 			<INPUT CLASS="sideBtn21" ID="ROWSET_HEADER" ACCESSKEY="E" TITLE="The header file for the rowset class. You can edit this file's name or select an existing header file." TYPE="text" onPropertyChange="OnRowsetName();">
				 	<BUTTON CLASS="buttonClass3Custom" ID="BROWSE_ROWSET_HEADER" TYPE="BUTTON" TITLE="Browse for header file." onClick="OnBrowseHeaderFile(this);">...</BUTTON>
				  </SPAN>
				</NOBR>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
  			  <TD VALIGN="TOP">
			  	<NOBR>
				  <SPAN CLASS="itemText" ID="ROWSET_IMPL_SPAN" TITLE="The provider's implementation file. You can edit this file's name or select an existing implementation file.">
	  	 			<LABEL FOR="ROWSET_IMPL" ID="ROWSET_IMPL_LABEL" TITLE="The provider's implementation file. You can edit this file's name or select an existing implementation file.">Rowset .c<U>p</U>p file:</LABEL>
	  	 			<BR>
	  	 			<INPUT CLASS="sideBtn21" ID="ROWSET_IMPL" ACCESSKEY="P" TITLE="The provider's implementation file. You can edit this file's name or select an existing implementation file." TYPE="text" onPropertyChange="window.external.AddSymbol('ROWSET_IMPL_VALID', false);">
				 	<BUTTON CLASS="buttonClass3Custom" ID="BrowseBtnImpl" TYPE="BUTTON" TITLE="Browse for implementation file." onClick="OnBrowseImplFile();">...</BUTTON>
				  </SPAN>
				</NOBR>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
			 
 			 <TR VALIGN="TOP">
  			  <TD VALIGN="TOP" HEIGHT="100%" COLSPAN="7">
  				&nbsp;
  			  </TD>
 			 </TR>
		 	</TABLE>
			
	   	  <!--CLOSE OF CONTENT//-->
		  </TD>
		 </TR>
		 <TR VALIGN="BOTTOM">
		  <TD HEIGHT="48">
	   	  <!--OPEN OF BUTTON HTML//-->
		  
		  	<TABLE HEIGHT="48" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="12">
			 <TR>
  			  <TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
				<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
  	 			 <TR VALIGN="TOP">
  	  			  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
  	  			  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
  	 			 </TR>
				</TABLE>
  			   </TD>
 			  </TR>
 
 			  <TR>
  			   <TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
  				&nbsp;
  			   </TD>
 			  </TR>
 
 			 <TR>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" HEIGHT="23">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">Finish</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">Cancel</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="window.external.OnHelp('vc.codewiz.class.atl.provider.overview');">Help</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
			</TABLE>
			
	   	  <!--CLOSE OF BUTTON HTML//-->
		  </TD>
		 </TR>
		</TABLE>
	
	   <!--CLOSE OF CONTENT AND BUTTON TABLE//-->
	   </TD>
	  </TR>
	 </TABLE>
	
	<!--CLOSE OF ALL ENCOMPASSING TABLE ROW TWO//-->
	</TD>
  </TR>
</TABLE>

</BODY>
</HTML>

<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();

function InitDocument(document)
{
	setDirection();
	
	if (window.external.FindSymbol("DOCUMENT_FIRST_LOAD"))
	{
		var L_WizardDialogTitle_Text = "ATL OLEDB Provider Wizard";
		window.external.AddSymbol("WIZARD_DIALOG_TITLE", L_WizardDialogTitle_Text);
		window.external.SetDefaults(document);
		var strProjName = window.external.FindSymbol("PROJECT_NAME");
		window.external.AddSymbol("SAFE_PROJECT_NAME", CreateSafeName(strProjName));
	}
	window.external.Load(document);
	if (IsAttributedProject(window.external))
	{
		ATTRIBUTED.checked = true;
		if (!CanAddNonAttributed())
		{
			ATTRIBUTED.disabled = true;
			ATTRIBUTED_LABEL.disabled = true;
		}
	}	
	COMMAND_HEADER_SECTION.disabled	= true;
	COMMAND_HEADER.disabled	= true;
	BROWSE_COMMAND_HEADER.disabled	= true;
}

function Next(document, linkto)
{
	ATTRIBUTED.disabled = false;
	window.external.Next(document, linkto);
}

function OnFinish(document)
{
	if (!ValidateInput())
		return;

	if (!ATTRIBUTED.disabled && ATTRIBUTED.checked)
		if (!ConvertProjectToAttributed())
			return;

	ATTRIBUTED.disabled = false;
	OnWizFinish(document);
}

function OnCoclass()
{
	var strCoclass = COCLASS.value;
	if (strCoclass.length)
	{
		var strProgID = window.external.FindSymbol("SAFE_PROJECT_NAME").substr(0,30) + "." + strCoclass;
		VERSION_INDEPENDENT_PROGID.value = strProgID.substr(0,39);
	}
	else
		VERSION_INDEPENDENT_PROGID.value = "";
}

function OnRowsetName()
{
	window.external.AddSymbol("ROWSET_HEADER_VALID", false);
	var strName = ROWSET_HEADER.value;
	COMMAND_HEADER.value = strName;
}

function OnShortName()
{
	var strShortName = SHORT_NAME.value;
	window.external.AddSymbol("SHORT_NAME", strShortName);
	if (strShortName.length)
	{
		COCLASS.value = strShortName;
		VERSION.value = "1";

		DATASOURCE_CLASS.value = "C" + strShortName + "Source";
		SESSION_CLASS.value = "C" + strShortName + "Session";
		COMMAND_CLASS.value = "C" + strShortName + "Command";
		ROWSET_CLASS.value = "C" + strShortName + "Rowset";
		DATASOURCE_HEADER.value = strShortName + "DS.h";
		SESSION_HEADER.value = strShortName + "Sess.h";
		COMMAND_HEADER.value = strShortName + "RS.h";
		ROWSET_HEADER.value = strShortName + "RS.h";
		ROWSET_IMPL.value = strShortName + "RS.cpp";
	}
	else	
	{
		COCLASS.value = "";
		VERSION.value = "";

		DATASOURCE_CLASS.value = "";
		SESSION_CLASS.value = "";
		COMMAND_CLASS.value = "";
		ROWSET_CLASS.value = "";
		DATASOURCE_HEADER.value = "";
		SESSION_HEADER.value = "";
		COMMAND_HEADER.value = "";
		ROWSET_HEADER.value = "";
		ROWSET_IMPL.value = "";
	}
	if (COCLASS.disabled)
		OnCoclass();
}

function OnBrowseHeaderFile(obj)
{
	var strCurrentEntry = "";
	switch(obj.id)
	{
		case "BRWOSE_DATASOURCE_HEADER":
			strCurrentEntry = DATASOURCE_HEADER.value;
			break;
		case "BRWOSE_SESSION_HEADER":
			strCurrentEntry = SESSION_HEADER.value;
			break;
		case "BROWSE_ROWSET_HEADER":
			strCurrentEntry = ROWSET_HEADER.value;
			break;
		case "BROWSE_COMMAND_HEADER":
			strCurrentEntry = COMMAND_HEADER.value;
			break;
		default:
			break;
	}

	var strFile;

	try
	{
		L_Title1_Text = "VS Wizards Select File";
		L_Title2_Text = "Visual C++ Header Files (*.h)\0*.h\0\0";
		strFile = window.external.GetOpenFileNameViaDlg(L_Title1_Text, window.external.FindSymbol("PROJECT_PATH"), L_Title2_Text, strCurrentEntry);
	}
	catch(e)
	{
		if (e.number != OLE_E_PROMPTSAVECANCELLED)
		{
			var L_ErrMsg1_Text = "Error in OnBrowseHeaderFile()";
			if (e.description.length != 0)
			{
				L_ErrMsg1_Text += ": ";
				L_ErrMsg1_Text += e.description;
			}
			window.external.ReportError(L_ErrMsg1_Text);
		}
		return;
	}

	switch(obj.id)
	{
		case "BRWOSE_DATASOURCE_HEADER":
			DATASOURCE_HEADER.value = strFile;
			break;
		case "BRWOSE_SESSION_HEADER":
			SESSION_HEADER.value = strFile;
			break;
		case "BROWSE_ROWSET_HEADER":
			ROWSET_HEADER.value = strFile;
			COMMAND_HEADER.value = strFile;
			break;
		case "BROWSE_COMMAND_HEADER":
			COMMAND_HEADER.value = strFile;
			break;
		default:
			break;
	}
}

function OnBrowseImplFile()
{
	var strFile;
	try
	{
		var L_Prompt1_Text = "VS Wizards Select File";
		var L_Prompt2_Text = "Visual C++ Files (*.cpp;*.h;*.inl;*.c)\0*.cpp;*.h;*.inl;*.c\0\0";
		strFile = window.external.GetOpenFileNameViaDlg( L_Prompt1_Text, window.external.FindSymbol("PROJECT_PATH"), L_Prompt2_Text, ROWSET_IMPL.value);
	}
	catch(e)
	{
		if (e.number != OLE_E_PROMPTSAVECANCELLED)
		{
			var L_ErrMsg2_Text = "Error in OnBrowseImplFile()";
			if (e.description.length != 0)
			{
				L_ErrMsg2_Text += ": ";
				L_ErrMsg2_Text += e.description;
			}
			window.external.ReportError(L_ErrMsg2_Text);
		}
		return;
	}
	ROWSET_IMPL.value = strFile;
}

function ValidateInput()
{
	var oInvalid = null;

	if (!Validate(SHORT_NAME))
		oInvalid = SHORT_NAME;

	if (oInvalid == null && !COCLASS.disabled)
		if (!Validate(COCLASS))
			oInvalid = COCLASS;

	if (oInvalid == null)
		if (!Validate(VERSION_INDEPENDENT_PROGID))
			oInvalid = VERSION_INDEPENDENT_PROGID;

	if (oInvalid == null)
		if (!Validate(VERSION))
			oInvalid = VERSION;

	if (oInvalid == null)
		if (!Validate(DATASOURCE_CLASS))
			oInvalid = DATASOURCE_CLASS;

	if (oInvalid == null)
		if (!Validate(SESSION_CLASS))
			oInvalid = SESSION_CLASS;

	if (oInvalid == null)
		if (!Validate(COMMAND_CLASS))
			oInvalid = COMMAND_CLASS;

	if (oInvalid == null)
		if (!Validate(ROWSET_CLASS))
			oInvalid = ROWSET_CLASS;

	if (oInvalid == null)
		if (!Validate(DATASOURCE_HEADER))
			oInvalid = DATASOURCE_HEADER;

	if (oInvalid == null)
		if (!Validate(SESSION_HEADER))
			oInvalid = SESSION_HEADER;

	if (oInvalid == null)
		if (!Validate(ROWSET_HEADER))
			oInvalid = ROWSET_HEADER;

	if (oInvalid == null)
		if (!Validate(ROWSET_IMPL))
			oInvalid = ROWSET_IMPL;

	if (oInvalid != null)
	{
		if (gbShowError)
			window.external.ReportError();
		else
			gbShowError = true;
		oInvalid.focus();
		return false;
	}
	var L_ErrMsg3_Text = "Duplicate class name(s)";
	if(DATASOURCE_CLASS.value==SESSION_CLASS.value ||
		DATASOURCE_CLASS.value==COMMAND_CLASS.value ||
		DATASOURCE_CLASS.value==ROWSET_CLASS.value)
	{
		window.external.ReportError(L_ErrMsg3_Text);
		DATASOURCE_CLASS.focus();
		return false;
	}
	if(SESSION_CLASS.value==COMMAND_CLASS.value ||
		SESSION_CLASS.value==ROWSET_CLASS.value)
	{
		window.external.ReportError(L_ErrMsg3_Text);
		SESSION_CLASS.focus();
		return false;
	}
	if(COMMAND_CLASS.value==ROWSET_CLASS.value)
	{
		window.external.ReportError(L_ErrMsg3_Text);
		COMMAND_CLASS.focus();
		return false;
	}
	return true;
}

var gbShowError = true;

function Validate(obj)
{
	var bValid = true;
	switch(obj.id)
	{
		case "SHORT_NAME":
			bValid = window.external.ProjectObject.CodeModel.IsValidID(obj.value);
			break;
		case "COCLASS":
			if (window.external.ParentObject.IDLLibraries.Count < 1)
			{
				var L_NoIDL_Text = "Adding a non-attributed ATL object requires an .IDL file.";
				oErrObj = new Error(L_NoIDL_Text);
				SetErrorInfo(oErrObj);
				bValid = false;				
			}
			else
				bValid = window.external.ParentObject.IDLLibraries(1).ValidateMember(obj.value, vsCMElementIDLCoClass);
			break;
		case "VERSION_INDEPENDENT_PROGID":
			bValid = window.external.IsValidProgID(obj.value);
			break;
		case "VERSION":
			bValid = window.external.IsValidNumericValue(obj.value);
			break;
		case "DATASOURCE_CLASS":
		case "SESSION_CLASS":
		case "COMMAND_CLASS":
		case "ROWSET_CLASS":
			bValid = window.external.ParentObject.ValidateMember(obj.value, vsCMElementClass);
			break;
		case "DATASOURCE_HEADER":
			if (!window.external.FindSymbol("DATASOURCE_HEADER_VALID"))
			{
				gbShowError = bValid = CanUseFileName(obj.value, true);
				if (!bValid)
					break;
				window.external.AddSymbol("DATASOURCE_HEADER_VALID", true)
			}
			bValid = ValidateFileNameAndEnsureInProject(obj.value);
			break;
		case "SESSION_HEADER":
			if (!window.external.FindSymbol("SESSION_HEADER_VALID"))
			{
				gbShowError = bValid = CanUseFileName(obj.value, true);
				if (!bValid)
					break;
				window.external.AddSymbol("SESSION_HEADER_VALID", true)
			}
			bValid = ValidateFileNameAndEnsureInProject(obj.value);
			break;
		case "ROWSET_HEADER":
			if (!window.external.FindSymbol("ROWSET_HEADER_VALID"))
			{
				gbShowError = bValid = CanUseFileName(obj.value, true);
				if (!bValid)
					break;
				window.external.AddSymbol("ROWSET_HEADER_VALID", true)
			}
			bValid = ValidateFileNameAndEnsureInProject(obj.value);
			break;
		case "ROWSET_IMPL":
			if (!window.external.FindSymbol("ROWSET_IMPL_VALID"))
			{
				gbShowError = bValid = CanUseFileName(obj.value);
				if (!bValid)
					break;
				window.external.AddSymbol("ROWSET_IMPL_VALID", true)
			}
			bValid = ValidateFileNameAndEnsureInProject(obj.value, vsCMValidateFileExtCppSource);
			break;
		default:
			break;
	}

	if (typeof(bValid) == "undefined")
		bValid = false;

	return bValid;
}

function OnAttributed()
{
	if (ATTRIBUTED.checked)
	{
		COCLASS_LABEL.disabled = true;
		COCLASS.disabled = true;
	}
	else
	{
		COCLASS_LABEL.disabled = false;
		COCLASS.disabled = false;
	}
}

</SCRIPT>
<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT>
	var strPath = "../../../../../";
	strPath += window.external.GetHostLocale();
	var strScriptPath = strPath + "/Script.js";
	var strCommonPath = strPath + "/Common.js";
	document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
	document.scripts("INCLUDE_COMMON").src = strCommonPath;
</SCRIPT>
