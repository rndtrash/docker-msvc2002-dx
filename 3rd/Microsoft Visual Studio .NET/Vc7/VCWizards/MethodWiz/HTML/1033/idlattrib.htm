<!- (c) 2001 Microsoft Corporation -->
<HTML DIR="LTR">

<HEAD>
	<TITLE>Add Method Wizard</TITLE>
	<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
	<STYLE TYPE="text/css">@import url();</STYLE>
	<SCRIPT>
		var strURL = "../../../";
		strURL += window.external.GetHostLocale();
		strURL += "/NewStyles.css";
		document.styleSheets(0).imports(0).href = strURL;
	</SCRIPT>
</HEAD>

<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="OnKey();" ONKEYPRESS="OnPress();">

<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<COL WIDTH="178">
	<!--OPEN OF ALL ENCOMPASSING TABLE ROW ONE//-->
  <TR VALIGN="TOP">
	<TD HEIGHT="79" WIDTH="100%" COLSPAN=2>
	 <TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
	 <COL WIDTH="12"><COL><COL WIDTH="12">
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
		<DIV CLASS="SMALLA" ID="Layer0">
		 <IMG CLASS="SMALLEST" SRC="..\..\Images\Method.gif" WIDTH="63" HEIGHT="63" ALT="" BORDER="0">
		</DIV>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65">
		<H4 CLASS="HEAD" ID="HEAD">IDL Attributes</H4>
		<P CLASS="SUBHEAD" ID="SUBHEAD">Specify any interface definition language settings for this method.</P>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
		<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
	  	 <TR VALIGN="TOP">
	  	  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
	  	  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
	  	 </TR>
		</TABLE>
	   </TD>
	  </TR>
	 </TABLE>
	</TD>
	</TR>
	 
	<!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
 
    <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
	<TR VALIGN="TOP">
	<TD CLASS="Three" VALIGN="TOP" HEIGHT="100%" WIDTH="178">
	 <TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="178" BORDER="0" CELLPADDING="0" CELLSPACING="0">
  	  <TR VALIGN="TOP">
	   <TD CLASS="threeCustom" VALIGN="TOP" STYLE="BACKGROUND-IMAGE: URL(../../Images/ATL_Method_Background.gif);">
	   <!--OPEN OF NAVIGATION TABLE//-->
	
	    <TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="12"><COL WIDTH="166"><COL WIDTH="1">
		 <TR>
	   	  <TD VALIGN="TOP" COLSPAN="3" HEIGHT="12">
	  		&nbsp;
		  </TD>
		 </TR>
		 <TR>
	   	  <TD VALIGN="TOP" HEIGHT="100%" WIDTH="12">
	  		&nbsp;
		  </TD>
	   	  <TD VALIGN="TOP" HEIGHT="100%" WIDTH="165">
	   	  <!--OPEN OF NAVIGATIONAL LINKS//-->
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="162">
				<SPAN CLASS="ACTIVELINK" ID="Default" TITLE="Specify method names and parameters." onClick="Next(document, 'default.htm');" TABINDEX="1">Names</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>

		  	<DIV CLASS="LINKSELECTED">
	 	   	 <SPAN CLASS="VERTLINE1">
			  <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
			 </SPAN>
			 <SPAN CLASS="HORILINE1">
			  <TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
				</TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD HEIGHT="100%">
				 <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="28" ALT="" BORDER="0">
			    </TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
			    </TD>
			   </TR>
			  </TABLE>
			 </SPAN>
			 <TABLE WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTSELECTED">
			  <TR VALIGN="MIDDLE">
			   <TD WIDTH="156">
				<SPAN ID="IDLAttrib" TITLE="Specify any IDL attributes for this method.">IDL Attributes</SPAN>
			   </TD>
			   <TD WIDTH="4">
				<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
			
	   	  <!--CLOSE OF NAVIGATIONAL LINKS//-->
		  </TD>
		  <TD WIDTH="1">
		   <DIV CLASS="VERTLINE">
			 <IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
		   </DIV>
		  </TD>
		 </TR>
		 </TABLE>
		</TD>
	   </TR>
	   </TABLE>
			
	   <!--CLOSE OF NAVIGATION TABLE//-->
	   </TD>


	<TD VALIGN="TOP" HEIGHT="100%">
	   <!--OPEN OF CONTENT AND BUTTON TABLE//-->
	   
	   	<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="100%">
		 <TR VALIGN="TOP">
		  <TD HEIGHT="100%">
	   	  <!--OPEN OF CONTENT//-->
		  
		  	<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="12">
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="3">
  				&nbsp;
  			  </TD>
 			 </TR>
			 
 			 <TR VALIGN="TOP">
 			 <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
				<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" STYLE="TABLE-LAYOUT:FIXED;">
				 <TR VALIGN="TOP">
				  <TD VALIGN="TOP" WIDTH="50%">
				  	<SPAN CLASS="itemTextTop" ID="DISPID_SPAN" TITLE="A numeric ID used to identify this method.">
					 <LABEL FOR="DISPID" ID="DISPID_LABEL">i<U>d</U>:</LABEL>
					 <BR>
					 <INPUT CLASS="sideBtn" TYPE="TEXT" ID="DISPID" ACCESSKEY="D">
					</SPAN>
				  	<SPAN CLASS="itemText" ID="CALL_AS_SPAN" TITLE="Enables you to map a function that cannot be called remotely to a remote function." STYLE="POSITION:RELATIVE; TOP:12PX;">
					 <LABEL FOR="CALL_AS" ID="CALL_AS_LABEL">c<u>a</u>ll_as:</LABEL>
					 <BR>
					 <INPUT CLASS="sideBtn" TYPE="TEXT" ID="CALL_AS" ACCESSKEY="A">
					</SPAN>
				  </TD>
				  <TD VALIGN="TOP" WIDTH="50%" STYLE="PADDING-LEFT:12PX;">
				  	<SPAN CLASS="itemTextTop" TYPE="TEXT" ID="HELP_CONTEXT_SPAN" TITLE="Specifies a context ID that lets the user view information about this element in the Help file.">
					 <LABEL FOR="HELP_CONTEXT" ID="HELP_CONTEXT_LABEL">helpconte<u>x</u>t:</LABEL>
					 <BR>
					 <INPUT CLASS="sideBtn" TYPE="TEXT" ID="HELP_CONTEXT" ACCESSKEY="X">
					</SPAN>
				  	<SPAN CLASS="itemText" ID="HELP_STRING_SPAN" TITLE="String description for this method." STYLE="POSITION:RELATIVE; TOP:12PX;">
					 <LABEL FOR="HELP_STRING" ID="HELP_STRING_LABEL">helpstrin<U>g</U>:</LABEL>
					 <BR>
					 <INPUT CLASS="sideBtn" TYPE="TEXT" ID="HELP_STRING" ACCESSKEY="G">
					</SPAN>
				  </TD>
				  </TR>
				
				<TR VALIGN="TOP">
				 <TD COLSPAN="2" HEIGHT="30">
				  &nbsp;
				 </TD>
				</TR>

				  <TR VALIGN="TOP">
				   <TD VALIGN="TOP" WIDTH="50">
					 <SPAN ID="HIDDEN_SPAN" TITLE="Indicates that the item exists but should not be displayed in a user-oriented browser.">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="HIDDEN" ACCESSKEY="E">
	  	 			  <DIV CLASS="itemTextCheckboxA">
		  			  <LABEL FOR="HIDDEN" ID="HIDDEN_LABEL">hidd<u>e</u>n</LABEL>
					  </DIV>
					  </SPAN>
					 
					<BR>
					
					 <SPAN ID="SOURCE_SPAN" TITLE="Indicates that this method is a source of events.">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="SOURCE" ACCESSKEY="S">
	  	 			  <DIV CLASS="itemTextCheckboxA">
	  	 			  <LABEL FOR="SOURCE" ID="SOURCE_LABEL"><u>s</u>ource</LABEL>
					  </DIV>
					  </SPAN>
					 
					<BR>
					
					 <SPAN ID="LOCAL_SPAN" TITLE="Specifies to the MIDL compiler that an interface or function is not remote.">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="LOCAL" ACCESSKEY="L">
	  	 			  <DIV CLASS="itemTextCheckboxA">
 	  	 			  <LABEL FOR="LOCAL" ID="LOCAL_LABEL"><u>l</u>ocal</LABEL>
					  </DIV>
					  </SPAN>
					 
					<BR>
					
					 <SPAN ID="RESTRICTED_SPAN" TITLE="Specifies that this method cannot be called arbitrarily.">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="RESTRICTED" ACCESSKEY="R">
	  	 			  <DIV CLASS="itemTextCheckboxA">
 	  	 			  <LABEL FOR="RESTRICTED" ID="RESTRICTED_LABEL"><u>r</u>estricted</LABEL>
					  </DIV>
					  </SPAN>
					 
					<BR>
					
					 <SPAN ID="VAR_ARG_SPAN" TITLE="Specifies that the function takes a variable number of arguments. To accomplish this, the last argument must be a safe array of VARIANT type that contains all the remaining arguments.">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="VAR_ARG" ACCESSKEY="V">
	  	 			  <DIV CLASS="itemTextCheckboxA">
 	  	 			  <LABEL id="VAR_ARG_LABEL" FOR="VAR_ARG"><u>v</u>ararg</LABEL>
					  </DIV>
					  </SPAN>
					 </NOBR>
					</SPAN>
				  </TD>
				 </TR>
				</TABLE>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
		 	</TABLE>
			
	   	  <!--CLOSE OF CONTENT//-->
		  </TD>
		 </TR>
		 <TR VALIGN="BOTTOM">
		  <TD HEIGHT="48">
	   	  <!--OPEN OF BUTTON HTML//-->
		  
		  	<TABLE HEIGHT="48" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="12">
			 <TR>
  			  <TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
				<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
  	 			 <TR VALIGN="TOP">
  	  			  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
  	  			  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
  	 			 </TR>
				</TABLE>
  			  </TD>
 			  </TR>
 
 			  <TR>
  			  <TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			<TR>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" HEIGHT="23">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">Finish</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">Cancel</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="window.external.OnHelp('vc.codewiz.method.idlattrib');">Help</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
			</TABLE>
			
	   	  <!--CLOSE OF BUTTON HTML//-->
		  </TD>
		 </TR>
		</TABLE>
	
	   <!--CLOSE OF CONTENT AND BUTTON TABLE//-->
	   </TD>
	  </TR>
	 </TABLE>

</BODY>
</HTML>

<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Default;
tab_array[1] = IDLAttrib;

var gbRetVal = false;

function InitDocument(document)
{
	setDirection();

	window.external.Load(document);

	if (window.external.FindSymbol("VAR_ARG_DISABLED"))
	{
		VAR_ARG.disabled = true;
		VAR_ARG_LABEL.disabled = true;
	}
	
	if (window.external.FindSymbol("DISPID_DISABLED"))
	{
		DISPID.disabled = true;
		DISPID_LABEL.disabled = true;
	}
}

function Next(document, linkto)
{
	if (!ValidateInput())
		return;
	window.external.Next(document, linkto);
}

function OnFinish(document)
{
	if (window.external.FindSymbol("EXTERNAL_NAME").length == 0)
	{
		var L_ErrMsg1_Text = "Need to specify a method name.";
		window.external.ReportError(L_ErrMsg1_Text);
		window.external.Next(document, "default.htm");
		return;
	}

	if (!ValidateInput())
		return;

	OnWizFinish(document);
}


function ValidateInput()
{
	try
	{
		if (!DISPID.disabled)
		{
			if (DISPID.value.length == 0)
			{
				var L_ErrMsg3_Text = "DISPID must be specified.";
				window.external.ReportError(L_ErrMsg3_Text);
				DISPID.focus();
				return false;
			}

			// convert to numeric
			var x = DISPID.value - 0;
			// if conversion failed
			if (isNaN(x))
			{
				var L_ErrMsg8_Text = "DISPID must be numeric.";
				window.external.ReportError(L_ErrMsg8_Text);
				DISPID.focus();
				return false;
			}
		}

		if (CALL_AS.value.length)
		{
			var oInterface = window.external.ParentObject;
			var oFunction = oInterface.Functions.Find(CALL_AS.value);

			if (!oFunction)
			{
				var L_ErrMsg4_Text = "call_as function must exist.";
				window.external.ReportError(L_ErrMsg4_Text);
				CALL_AS.focus();
				return false;
			}
			else
			{
				if (!oFunction.Attributes.Find("local"))
				{
					var L_ErrMsg5_Text = "call_as function must have [local] attribute.";
					window.external.ReportError(L_ErrMsg5_Text);
					CALL_AS.focus();
					return false;
				}
				else if (oFunction.Attributes.Find("propput") || oFunction.Attributes.Find("propget") || oFunction.Attributes.Find("propputref"))
				{
					var L_ErrMsg9_Text = "call_as function cannot be [propput] or [propget] or [propputref].";
					window.external.ReportError(L_ErrMsg9_Text);
					CALL_AS.focus();
					return false;
				}
			}
		}

		if (HELP_CONTEXT.value.length)
		{
			// convert to numeric
			var x = HELP_CONTEXT.value - 0;
			// if conversion failed
			if (isNaN(x))
			{
				var L_ErrMsg6_Text = "helpcontext must be numeric.";
				window.external.ReportError(L_ErrMsg6_Text);
				HELP_CONTEXT.focus();
				return false;
			}
		}
		return true;
	}
	catch(e)
	{
		var L_ErrMsg7_Text = "Error in ValidateInput()";
		if (e.description.length != 0)
		{
			L_ErrMsg7_Text += ": ";
			L_ErrMsg7_Text += e.description;
		}
		window.external.ReportError(L_ErrMsg7_Text);
		return false;
	}
}
</SCRIPT>

<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT>
	var strPath = "../../../";
	strPath += window.external.GetHostLocale();
	var strScriptPath = strPath + "/Script.js";
	var strCommonPath = strPath + "/Common.js";
	document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
	document.scripts("INCLUDE_COMMON").src = strCommonPath;
</SCRIPT>
